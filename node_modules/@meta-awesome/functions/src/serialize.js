import isEmpty from 'lodash/isEmpty';
import map from 'lodash/map';

/**
 * Serialize an object or array to encode URI
 * @param {Object | Array} obj Object/Array to encode
 * @param {Object} config Object/Array to encode
 * @return {Object}
 * @property {Boolean} clean remove %22 encoded
 * */
const serialize = (obj, config = {}) => {
  if (!isEmpty(obj)) {
    const response = map(
      obj,
      (value, key) => `${key}=${encodeURIComponent(JSON.stringify(value))}`
    );
    const str = response.join('&');
    if (config.clean) {
      return str.split('%22').join('');
    }
    return str;
  }
  return '';
};

export default serialize;
