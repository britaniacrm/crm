{"ast":null,"code":"var _jsxFileName = \"/home/rafael/Documentos/britania/COM-front/packages/web/src/modules/customers/screens/CustomerFormScreen/Ranking.js\";\nimport React, { useMemo, useCallback } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { useHistory } from 'react-router';\nimport PropTypes from 'prop-types';\nimport isNumber from 'lodash/isNumber';\nimport Grid from '@material-ui/core/Grid';\nimport Typography from '@material-ui/core/Typography';\nimport { useDialog } from '@britania-crm/dialog';\nimport I18n, { useT } from '@britania-crm/i18n';\nimport { customer as customerCrmRoutes } from '@britania-crm/services/apis/crmApi/resources/routes';\nimport { CustomerActions } from '@britania-crm/stores/customer';\nimport Button from '@britania-crm/web-components/Button';\nimport CustomAccordion from '@britania-crm/web-components/CustomAccordion';\nimport DataTable from '@britania-crm/web-components/DataTable';\nimport RankingBadge from '@britania-crm/web-components/RankingBadge';\nimport WorkFlowExecution from '@britania-crm/web-src/modules/workflow/containers/WorkFlowExecution';\nimport WorkFlowHistoryModal from '../../../workflow/modals/WorkFlowHistoryModal/WorkFlowHistoryModal';\nimport RankingChangeModal from '../../modals/RankingChangeModal';\nimport useStyles, { HistoryButton } from './styles';\n\nconst Ranking = ({\n  matrixCode,\n  data,\n  currentRanking,\n  oldRanking,\n  isDisabled,\n  handleDocumentation,\n  hasPermission,\n  viewMode,\n  workflowTaskInProgress,\n  workflowInProgress,\n  id\n}) => {\n  const t = useT();\n  const dispatch = useDispatch();\n  const classes = useStyles();\n  const history = useHistory();\n  const {\n    createDialog\n  } = useDialog();\n  const assumptionsData = useMemo(() => [{\n    assumptions: '% Crescimento',\n    lastPercentage: isNumber(data === null || data === void 0 ? void 0 : data.growth) ? `${data === null || data === void 0 ? void 0 : data.growth}%` : '-'\n  }, {\n    assumptions: '% Devolução',\n    lastPercentage: isNumber(data === null || data === void 0 ? void 0 : data.devolution) ? `${data === null || data === void 0 ? void 0 : data.devolution}%` : '-'\n  }, {\n    assumptions: '% Introdução de Produto',\n    lastPercentage: isNumber(data === null || data === void 0 ? void 0 : data.productIntroduction) ? `${data === null || data === void 0 ? void 0 : data.productIntroduction}%` : '-'\n  }, {\n    assumptions: 'Condição de Pagamento',\n    lastPercentage: isNumber(data === null || data === void 0 ? void 0 : data.paymentTerms) ? `${data === null || data === void 0 ? void 0 : data.paymentTerms}%` : '-'\n  }], [data]);\n  const columns = useMemo(() => [{\n    title: t('assumptions'),\n    field: 'assumptions'\n  }, {\n    title: t('last percentage', {\n      howMany: 1\n    }),\n    field: 'lastPercentage'\n  }], [t]);\n  const onClickAlterRanking = useCallback(() => createDialog({\n    id: `alter-ranking-modal-${matrixCode}`,\n    Component: RankingChangeModal,\n    props: {\n      onSuccess(values) {\n        dispatch(CustomerActions.changeRankings(matrixCode, values, () => {\n          history.go(0);\n        }));\n      },\n\n      matrixCode\n    }\n  }), [createDialog, dispatch, history, matrixCode]);\n  const handleOpenWorkflowHistoryModal = useCallback(() => createDialog({\n    id: 'WorkFlowModal',\n    Component: WorkFlowHistoryModal,\n    props: {\n      baseUrl: `${customerCrmRoutes.getOne}/ ${id}/ranking`\n    }\n  }), [createDialog, id]);\n  return /*#__PURE__*/React.createElement(CustomAccordion, {\n    header: t('ranking'),\n    handleInfo: handleDocumentation,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    item: true,\n    spacing: 1,\n    sm: 12,\n    className: classes.containerRanking,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    sm: 12,\n    md: 4,\n    className: classes.ranking,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(I18n, {\n    as: Typography,\n    variant: \"body2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 11\n    }\n  }, \"previous ranking\"), /*#__PURE__*/React.createElement(RankingBadge, {\n    type: oldRanking,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    sm: 12,\n    md: 4,\n    className: classes.ranking,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(I18n, {\n    as: Typography,\n    variant: \"body2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 11\n    }\n  }, \"current ranking\"), /*#__PURE__*/React.createElement(RankingBadge, {\n    type: currentRanking,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    sm: 12,\n    md: 4,\n    className: classes.ranking,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 9\n    }\n  }, !isDisabled && /*#__PURE__*/React.createElement(I18n, {\n    as: Button,\n    color: \"secondary\",\n    variant: \"contained\",\n    className: classes.btnSave,\n    onClick: onClickAlterRanking,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 15\n    }\n  }, \"request ranking change\")), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    sm: 12,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(DataTable, {\n    data: assumptionsData,\n    columns: columns,\n    options: {\n      search: false\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 11\n    }\n  })), hasPermission && !isDisabled && /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    sm: 12,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(WorkFlowExecution, {\n    baseUrl: `${customerCrmRoutes.getOne}/${id}/ranking`,\n    taskInProgress: workflowTaskInProgress,\n    workflowInProgress: workflowInProgress,\n    fieldDescription: \"requestedRanking.description\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 13\n    }\n  })), hasPermission && viewMode && /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    sm: 12,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(I18n, {\n    as: HistoryButton,\n    onClick: handleOpenWorkflowHistoryModal,\n    color: \"default\",\n    variant: \"outlined\",\n    style: {\n      marginTop: 10\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 13\n    }\n  }, \"workflow history\"))));\n};\n\nRanking.propTypes = {\n  data: PropTypes.array,\n  currentRanking: PropTypes.string,\n  oldRanking: PropTypes.string,\n  matrixCode: PropTypes.number,\n  isDisabled: PropTypes.bool,\n  handleDocumentation: PropTypes.func,\n  hasPermission: PropTypes.bool,\n  viewMode: PropTypes.bool,\n  workflowTaskInProgress: PropTypes.object,\n  workflowInProgress: PropTypes.object,\n  id: PropTypes.oneOfType([PropTypes.string, PropTypes.number])\n};\nRanking.defaultProps = {\n  data: [],\n  matrixCode: null,\n  currentRanking: '',\n  oldRanking: '',\n  isDisabled: false,\n\n  handleDocumentation() {},\n\n  workflowTaskInProgress: {},\n  workflowInProgress: {},\n  id: '',\n  hasPermission: false,\n  viewMode: false\n};\nexport default Ranking;","map":{"version":3,"sources":["/home/rafael/Documentos/britania/COM-front/packages/web/src/modules/customers/screens/CustomerFormScreen/Ranking.js"],"names":["React","useMemo","useCallback","useDispatch","useHistory","PropTypes","isNumber","Grid","Typography","useDialog","I18n","useT","customer","customerCrmRoutes","CustomerActions","Button","CustomAccordion","DataTable","RankingBadge","WorkFlowExecution","WorkFlowHistoryModal","RankingChangeModal","useStyles","HistoryButton","Ranking","matrixCode","data","currentRanking","oldRanking","isDisabled","handleDocumentation","hasPermission","viewMode","workflowTaskInProgress","workflowInProgress","id","t","dispatch","classes","history","createDialog","assumptionsData","assumptions","lastPercentage","growth","devolution","productIntroduction","paymentTerms","columns","title","field","howMany","onClickAlterRanking","Component","props","onSuccess","values","changeRankings","go","handleOpenWorkflowHistoryModal","baseUrl","getOne","containerRanking","ranking","btnSave","search","marginTop","propTypes","array","string","number","bool","func","object","oneOfType","defaultProps"],"mappings":"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","sourcesContent":["import React, {\n  useMemo,\n  useCallback\n} from 'react'\nimport { useDispatch } from 'react-redux'\nimport { useHistory } from 'react-router'\n\nimport PropTypes from 'prop-types'\n\nimport isNumber from 'lodash/isNumber'\n\nimport Grid from '@material-ui/core/Grid'\nimport Typography from '@material-ui/core/Typography'\n\nimport { useDialog } from '@britania-crm/dialog'\nimport I18n, { useT } from '@britania-crm/i18n'\nimport { customer as customerCrmRoutes } from '@britania-crm/services/apis/crmApi/resources/routes'\nimport { CustomerActions } from '@britania-crm/stores/customer'\nimport Button from '@britania-crm/web-components/Button'\nimport CustomAccordion from '@britania-crm/web-components/CustomAccordion'\nimport DataTable from '@britania-crm/web-components/DataTable'\nimport RankingBadge from '@britania-crm/web-components/RankingBadge'\nimport WorkFlowExecution from '@britania-crm/web-src/modules/workflow/containers/WorkFlowExecution'\n\nimport WorkFlowHistoryModal from '../../../workflow/modals/WorkFlowHistoryModal/WorkFlowHistoryModal'\nimport RankingChangeModal from '../../modals/RankingChangeModal'\nimport useStyles, { HistoryButton } from './styles'\n\nconst Ranking = ({\n  matrixCode,\n  data,\n  currentRanking,\n  oldRanking,\n  isDisabled,\n  handleDocumentation,\n  hasPermission,\n  viewMode,\n  workflowTaskInProgress,\n  workflowInProgress,\n  id\n}) => {\n  const t = useT()\n  const dispatch = useDispatch()\n  const classes = useStyles()\n  const history = useHistory()\n  const { createDialog } = useDialog()\n\n  const assumptionsData = useMemo(() =>\n    [\n      {\n        assumptions: '% Crescimento',\n        lastPercentage: isNumber(data?.growth) ? `${ data?.growth }%` : '-'\n      },\n      {\n        assumptions: '% Devolução',\n        lastPercentage: isNumber(data?.devolution) ? `${ data?.devolution }%` : '-'\n      },\n      {\n        assumptions: '% Introdução de Produto',\n        lastPercentage: isNumber(data?.productIntroduction) ? `${ data?.productIntroduction }%` : '-'\n      },\n      {\n        assumptions: 'Condição de Pagamento',\n        lastPercentage: isNumber(data?.paymentTerms) ? `${ data?.paymentTerms }%` : '-'\n      }\n\n    ]\n  , [data])\n\n  const columns = useMemo(() => [\n    {\n      title: t('assumptions'),\n      field: 'assumptions'\n    },\n    {\n      title: t('last percentage', { howMany: 1 }),\n      field: 'lastPercentage'\n    }\n  ], [t])\n\n  const onClickAlterRanking = useCallback(\n    () => createDialog({\n      id: `alter-ranking-modal-${ matrixCode }`,\n      Component: RankingChangeModal,\n      props: {\n        onSuccess (values) {\n          dispatch(CustomerActions.changeRankings(matrixCode, values, () => {\n            history.go(0)\n          }))\n        },\n        matrixCode\n      }\n    }),\n    [createDialog, dispatch, history, matrixCode]\n  )\n\n  const handleOpenWorkflowHistoryModal = useCallback(\n    () => createDialog({\n      id: 'WorkFlowModal',\n      Component: WorkFlowHistoryModal,\n      props: { baseUrl: `${ customerCrmRoutes.getOne }/ ${ id }/ranking` }\n    }),\n    [createDialog, id]\n  )\n\n  return (\n    <CustomAccordion header={ t('ranking') } handleInfo={ handleDocumentation }>\n      <Grid container item spacing={ 1 } sm={ 12 } className={ classes.containerRanking }>\n        <Grid item sm={ 12 } md={ 4 } className={ classes.ranking }>\n          <I18n as={ Typography } variant=\"body2\" >\n          previous ranking\n          </I18n>\n          <RankingBadge type={ oldRanking } />\n        </Grid>\n        <Grid item sm={ 12 } md={ 4 } className={ classes.ranking }>\n          <I18n as={ Typography } variant=\"body2\">\n          current ranking\n          </I18n>\n          <RankingBadge type={ currentRanking } />\n        </Grid>\n        <Grid item sm={ 12 } md={ 4 } className={ classes.ranking }>\n          {\n            !isDisabled && (\n              <I18n as={ Button }\n                color=\"secondary\"\n                variant=\"contained\"\n                className={ classes.btnSave }\n                onClick={ onClickAlterRanking }\n              >\n            request ranking change\n              </I18n>\n            )\n          }\n        </Grid>\n        <Grid item sm={ 12 }>\n          <DataTable\n            data={ assumptionsData }\n            columns={ columns }\n            options={ { search: false } }\n          />\n        </Grid>\n        {hasPermission && !isDisabled && (\n          <Grid item sm={ 12 }>\n            <WorkFlowExecution\n              baseUrl={ `${ customerCrmRoutes.getOne }/${ id }/ranking` }\n              taskInProgress={ workflowTaskInProgress }\n              workflowInProgress={ workflowInProgress }\n              fieldDescription=\"requestedRanking.description\"\n            />\n          </Grid>\n        )}\n        {hasPermission && viewMode && (\n          <Grid item sm={ 12 }>\n            <I18n\n              as={ HistoryButton }\n              onClick={ handleOpenWorkflowHistoryModal }\n              color=\"default\"\n              variant=\"outlined\"\n              style={ { marginTop: 10 } }\n            >\n          workflow history\n            </I18n>\n          </Grid>\n        )}\n      </Grid>\n    </CustomAccordion>\n  )\n}\n\nRanking.propTypes = {\n  data: PropTypes.array,\n  currentRanking: PropTypes.string,\n  oldRanking: PropTypes.string,\n  matrixCode: PropTypes.number,\n  isDisabled: PropTypes.bool,\n  handleDocumentation: PropTypes.func,\n  hasPermission: PropTypes.bool,\n  viewMode: PropTypes.bool,\n  workflowTaskInProgress: PropTypes.object,\n  workflowInProgress: PropTypes.object,\n  id: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.number\n  ])\n}\n\nRanking.defaultProps = {\n  data: [],\n  matrixCode: null,\n  currentRanking: '',\n  oldRanking: '',\n  isDisabled: false,\n  handleDocumentation () {},\n  workflowTaskInProgress: {},\n  workflowInProgress: {},\n  id: '',\n  hasPermission: false,\n  viewMode: false\n}\n\nexport default Ranking\n"]},"metadata":{},"sourceType":"module"}