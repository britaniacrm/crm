{"ast":null,"code":"import { put, call, takeLatest } from 'redux-saga/effects';\nimport doDownloadFile from 'js-file-download';\nimport { MSG027, MSG033 } from '@britania-crm/constants/feedbackMessages.constants';\nimport { download } from '@britania-crm/services/apis/crmApi/resources/app.service';\nimport { deleteFile, uploadSingleFile } from '@britania-crm/services/apis/crmApi/resources/file.service';\nimport { saveRepresentative, concludeRepresentative, updateRepresentative } from '@britania-crm/services/apis/crmApi/resources/representative.service';\nimport { AppActions } from '../app/app.actions';\nimport { RepresentativeTypes } from './representative.actions';\n\nfunction* doSaveRepresentative({\n  representative,\n  onSuccess = () => {},\n  onError = () => {}\n}) {\n  try {\n    const {\n      status\n    } = yield call(saveRepresentative, representative);\n\n    if (status === 201) {\n      yield call(onSuccess);\n      yield put(AppActions.addAlert({\n        type: 'success',\n        message: 'Cadastro salvo com sucesso!'\n      }));\n    }\n  } catch (error) {\n    yield put(AppActions.addAlert({\n      type: 'error',\n      message: 'Falha ao solicitar pré-cadastro de representante'\n    }));\n    yield call(onError);\n  }\n}\n\nfunction* doConcludeRepresentative({\n  representative,\n  onSuccess = () => {},\n  onError = () => {}\n}) {\n  try {\n    const {\n      status\n    } = yield call(concludeRepresentative, representative);\n\n    if (status === 201) {\n      yield call(onSuccess);\n      yield put(AppActions.addAlert({\n        type: 'success',\n        message: 'Workflow em andamento'\n      }));\n    }\n  } catch (error) {\n    yield put(AppActions.addAlert({\n      type: 'error',\n      message: 'Falha ao concluir o salvamento do pré-cadastro de representante'\n    }));\n    yield call(onError);\n  }\n}\n\nfunction* doUpdateRepresentative({\n  params,\n  id,\n  onSuccess = () => {},\n  onError = () => {}\n}) {\n  try {\n    const {\n      status\n    } = yield call(updateRepresentative, params, id);\n\n    if (status === 200) {\n      yield call(onSuccess);\n      yield put(AppActions.addAlert({\n        type: 'success',\n        message: MSG027\n      }));\n    }\n  } catch (error) {\n    yield put(AppActions.addAlert({\n      type: 'error',\n      message: 'Falha ao solicitar alteração cadastral do representante'\n    }));\n    yield call(onError);\n  }\n}\n\nfunction* doUploadFileRepresentative({\n  data,\n  onSuccess\n}) {\n  try {\n    if ((data === null || data === void 0 ? void 0 : data.file) instanceof File) {\n      const formData = new FormData();\n      formData.append('file', data.file);\n      const response = yield call(uploadSingleFile, formData);\n      yield call(onSuccess, { ...data,\n        file: { ...response\n        },\n        fileId: response.id,\n        path: response === null || response === void 0 ? void 0 : response.path\n      });\n      yield put(AppActions.addAlert({\n        type: 'success',\n        message: 'Arquivo salvo com sucesso!'\n      }));\n    } else {\n      yield call(onSuccess, data);\n    }\n  } catch (error) {\n    yield put(AppActions.addAlert({\n      type: 'error',\n      message: MSG033\n    }));\n  }\n}\n\nfunction* doDeleteFileRepresentative({\n  data,\n  onSuccess\n}) {\n  try {\n    yield call(deleteFile, data);\n    yield call(onSuccess);\n  } catch (error) {\n    yield put(AppActions.addAlert({\n      type: 'error',\n      message: MSG033\n    }));\n  }\n}\n\nfunction* doDowloadFileRepresentative({\n  url,\n  filename,\n  onSuccess = () => {}\n}) {\n  try {\n    const response = yield call(download, encodeURIComponent(url));\n    doDownloadFile(response, filename);\n    yield call(onSuccess, false);\n  } catch (error) {\n    yield put(AppActions.addAlert({\n      type: 'error',\n      message: 'Falha ao baixar arquivo!'\n    }));\n  }\n}\n\nexport default [takeLatest(RepresentativeTypes.SAVE_REPRESENTATIVE, doSaveRepresentative), takeLatest(RepresentativeTypes.CONCLUDE_REPRESENTATIVE, doConcludeRepresentative), takeLatest(RepresentativeTypes.UPDATE_REPRESENTATIVE, doUpdateRepresentative), takeLatest(RepresentativeTypes.UPLOAD_FILE_REPRESENTATIVE, doUploadFileRepresentative), takeLatest(RepresentativeTypes.DOWNLOAD_FILE_REPRESENTATIVE, doDowloadFileRepresentative), takeLatest(RepresentativeTypes.DELETE_FILE_REPRESENTATIVE, doDeleteFileRepresentative)];","map":{"version":3,"sources":["/home/rafael/Documentos/britania/COM-front/packages/core/stores/representative/representative.sagas.js"],"names":["put","call","takeLatest","doDownloadFile","MSG027","MSG033","download","deleteFile","uploadSingleFile","saveRepresentative","concludeRepresentative","updateRepresentative","AppActions","RepresentativeTypes","doSaveRepresentative","representative","onSuccess","onError","status","addAlert","type","message","error","doConcludeRepresentative","doUpdateRepresentative","params","id","doUploadFileRepresentative","data","file","File","formData","FormData","append","response","fileId","path","doDeleteFileRepresentative","doDowloadFileRepresentative","url","filename","encodeURIComponent","SAVE_REPRESENTATIVE","CONCLUDE_REPRESENTATIVE","UPDATE_REPRESENTATIVE","UPLOAD_FILE_REPRESENTATIVE","DOWNLOAD_FILE_REPRESENTATIVE","DELETE_FILE_REPRESENTATIVE"],"mappings":"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","sourcesContent":["import {\n  put,\n  call,\n  takeLatest\n} from 'redux-saga/effects'\n\nimport doDownloadFile from 'js-file-download'\n\nimport {\n  MSG027,\n  MSG033\n} from '@britania-crm/constants/feedbackMessages.constants'\nimport { download } from '@britania-crm/services/apis/crmApi/resources/app.service'\nimport {\n  deleteFile,\n  uploadSingleFile\n} from '@britania-crm/services/apis/crmApi/resources/file.service'\nimport {\n  saveRepresentative,\n  concludeRepresentative,\n  updateRepresentative\n} from '@britania-crm/services/apis/crmApi/resources/representative.service'\n\nimport { AppActions } from '../app/app.actions'\nimport { RepresentativeTypes } from './representative.actions'\n\nfunction* doSaveRepresentative ({\n  representative,\n  onSuccess = () => {},\n  onError = () => {}\n}) {\n  try {\n    const { status } = yield call(saveRepresentative, representative)\n\n    if (status === 201) {\n      yield call(onSuccess)\n      yield put(AppActions.addAlert({ type: 'success', message: 'Cadastro salvo com sucesso!' }))\n    }\n  } catch (error) {\n    yield put(AppActions.addAlert({ type: 'error', message: 'Falha ao solicitar pré-cadastro de representante' }))\n    yield call(onError)\n  }\n}\n\nfunction* doConcludeRepresentative ({\n  representative,\n  onSuccess = () => {},\n  onError = () => {}\n}) {\n  try {\n    const { status } = yield call(concludeRepresentative, representative)\n\n    if (status === 201) {\n      yield call(onSuccess)\n      yield put(AppActions.addAlert({ type: 'success', message: 'Workflow em andamento' }))\n    }\n  } catch (error) {\n    yield put(AppActions.addAlert({ type: 'error', message: 'Falha ao concluir o salvamento do pré-cadastro de representante' }))\n    yield call(onError)\n  }\n}\n\nfunction* doUpdateRepresentative ({\n  params,\n  id,\n  onSuccess = () => {},\n  onError = () => {}\n}) {\n  try {\n    const { status } = yield call(updateRepresentative, params, id)\n\n    if (status === 200) {\n      yield call(onSuccess)\n      yield put(AppActions.addAlert({ type: 'success', message: MSG027 }))\n    }\n  } catch (error) {\n    yield put(AppActions.addAlert({ type: 'error', message: 'Falha ao solicitar alteração cadastral do representante' }))\n    yield call(onError)\n  }\n}\n\nfunction* doUploadFileRepresentative ({ data, onSuccess }) {\n  try {\n    if (data?.file instanceof File) {\n      const formData = new FormData()\n      formData.append('file', data.file)\n      const response = yield call(uploadSingleFile, formData)\n\n      yield call(onSuccess, {\n        ...data,\n        file: { ...response },\n        fileId: response.id,\n        path: response?.path\n      })\n      yield put(AppActions.addAlert({ type: 'success', message: 'Arquivo salvo com sucesso!' }))\n    } else {\n      yield call(onSuccess, data)\n    }\n  } catch (error) {\n    yield put(AppActions.addAlert({ type: 'error', message: MSG033 }))\n  }\n}\n\nfunction* doDeleteFileRepresentative ({ data, onSuccess }) {\n  try {\n    yield call(deleteFile, data)\n    yield call(onSuccess)\n  } catch (error) {\n    yield put(AppActions.addAlert({ type: 'error', message: MSG033 }))\n  }\n}\n\nfunction* doDowloadFileRepresentative ({\n  url, filename, onSuccess = () => {}\n}) {\n  try {\n    const response = yield call(download, encodeURIComponent(url))\n\n    doDownloadFile(response, filename)\n    yield call(onSuccess, false)\n  } catch (error) {\n    yield put(AppActions.addAlert({ type: 'error', message: 'Falha ao baixar arquivo!' }))\n  }\n}\n\nexport default [\n  takeLatest(RepresentativeTypes.SAVE_REPRESENTATIVE, doSaveRepresentative),\n  takeLatest(RepresentativeTypes.CONCLUDE_REPRESENTATIVE, doConcludeRepresentative),\n  takeLatest(RepresentativeTypes.UPDATE_REPRESENTATIVE, doUpdateRepresentative),\n  takeLatest(RepresentativeTypes.UPLOAD_FILE_REPRESENTATIVE, doUploadFileRepresentative),\n  takeLatest(RepresentativeTypes.DOWNLOAD_FILE_REPRESENTATIVE, doDowloadFileRepresentative),\n  takeLatest(RepresentativeTypes.DELETE_FILE_REPRESENTATIVE, doDeleteFileRepresentative)\n]\n"]},"metadata":{},"sourceType":"module"}