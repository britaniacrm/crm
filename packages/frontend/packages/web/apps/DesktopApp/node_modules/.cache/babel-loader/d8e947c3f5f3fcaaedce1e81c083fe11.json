{"ast":null,"code":"var _jsxFileName = \"/home/rafael/Documentos/britania/COM-front/packages/web/src/modules/customers/containers/CommercialReferencesTable/CommercialReferencesTable.js\";\nimport React, { useMemo, useCallback, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport filter from 'lodash/filter';\nimport map from 'lodash/map';\nimport { useDialog } from '@britania-crm/dialog';\nimport { useT } from '@britania-crm/i18n';\nimport { formatPhone } from '@britania-crm/utils/formatters';\nimport DataTable from '@britania-crm/web-components/DataTable';\nimport InputHidden from '@britania-crm/web-components/InputHidden';\nimport ConfirmModal from '@britania-crm/web-components/Modal/ConfirmModal';\nimport NewCommercialReferenceModal from '@britania-crm/web-src/modules/customers/modals/NewCommercialReferenceModal';\n\nconst CommercialReferencesTable = ({\n  disabled,\n  formRef\n}) => {\n  const t = useT();\n  const {\n    createDialog\n  } = useDialog();\n  const [commercialReferences, setCommercialReferences] = useState([]);\n  const columns = useMemo(() => [{\n    title: t('name', {\n      howMany: 1\n    }),\n    field: 'name'\n  }, {\n    title: t('phone', {\n      howMany: 1\n    }),\n    field: 'phone',\n    render: row => formatPhone(row === null || row === void 0 ? void 0 : row.phone) || '-'\n  }], [t]);\n  const onAddClick = useCallback(() => createDialog({\n    id: 'modal-add-new-commercial-reference',\n    Component: NewCommercialReferenceModal,\n    props: {\n      onSubmit(commercialReference) {\n        formRef.current.setFieldValue('additionalInformation.commercialReferences', old => [...old, commercialReference]);\n      }\n\n    }\n  }), [createDialog, formRef]);\n  const onEditClick = useCallback((_, row) => createDialog({\n    id: 'modal-edit-commercial-reference',\n    Component: NewCommercialReferenceModal,\n    props: {\n      commercialReference: row,\n\n      onSubmit(commercialReference) {\n        formRef.current.setFieldValue('additionalInformation.commercialReferences', old => map(old, (item, index) => index === row.tableData.id ? {\n          id: row.id,\n          ...commercialReference\n        } : item));\n      }\n\n    }\n  }), [createDialog, formRef]);\n  const onDeleteClick = useCallback((_, row) => createDialog({\n    id: 'modal-delete-commercial-reference',\n    Component: ConfirmModal,\n    props: {\n      onConfirm() {\n        formRef.current.setFieldValue('additionalInformation.commercialReferences', old => filter(old, (item, index) => index !== row.tableData.id));\n      }\n\n    }\n  }), [createDialog, formRef]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(DataTable, {\n    options: {\n      search: false\n    },\n    data: commercialReferences,\n    columns: columns,\n    title: t('commercial reference', {\n      howMany: 2\n    }),\n    titleProps: {\n      variant: 'h6'\n    },\n    addTitle: t('add new {this}', {\n      this: t('commercial reference', {\n        howMany: 1\n      }),\n      gender: 'female'\n    }),\n    minimalistToolbar: true,\n    onAddClick: !disabled && onAddClick,\n    onEditClick: !disabled && onEditClick,\n    onDeleteClick: !disabled && onDeleteClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(InputHidden, {\n    name: \"commercialReferences\",\n    showError: true,\n    onValueChange: setCommercialReferences,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }\n  }));\n};\n\nCommercialReferencesTable.propTypes = {\n  formRef: PropTypes.any.isRequired,\n  disabled: PropTypes.bool.isRequired\n};\nexport default CommercialReferencesTable;","map":{"version":3,"sources":["/home/rafael/Documentos/britania/COM-front/packages/web/src/modules/customers/containers/CommercialReferencesTable/CommercialReferencesTable.js"],"names":["React","useMemo","useCallback","useState","PropTypes","filter","map","useDialog","useT","formatPhone","DataTable","InputHidden","ConfirmModal","NewCommercialReferenceModal","CommercialReferencesTable","disabled","formRef","t","createDialog","commercialReferences","setCommercialReferences","columns","title","howMany","field","render","row","phone","onAddClick","id","Component","props","onSubmit","commercialReference","current","setFieldValue","old","onEditClick","_","item","index","tableData","onDeleteClick","onConfirm","search","variant","this","gender","propTypes","any","isRequired","bool"],"mappings":"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","sourcesContent":["import React, {\n  useMemo,\n  useCallback,\n  useState\n} from 'react'\n\nimport PropTypes from 'prop-types'\n\nimport filter from 'lodash/filter'\nimport map from 'lodash/map'\n\nimport { useDialog } from '@britania-crm/dialog'\nimport { useT } from '@britania-crm/i18n'\nimport { formatPhone } from '@britania-crm/utils/formatters'\nimport DataTable from '@britania-crm/web-components/DataTable'\nimport InputHidden from '@britania-crm/web-components/InputHidden'\nimport ConfirmModal from '@britania-crm/web-components/Modal/ConfirmModal'\nimport NewCommercialReferenceModal from '@britania-crm/web-src/modules/customers/modals/NewCommercialReferenceModal'\n\nconst CommercialReferencesTable = ({ disabled, formRef }) => {\n  const t = useT()\n  const { createDialog } = useDialog()\n\n  const [commercialReferences, setCommercialReferences] = useState([])\n\n  const columns = useMemo(\n    () => [\n      {\n        title: t('name', { howMany: 1 }),\n        field: 'name'\n      },\n      {\n        title: t('phone', { howMany: 1 }),\n        field: 'phone',\n        render: (row) => formatPhone(row?.phone) || '-'\n      }\n    ],\n    [t]\n  )\n\n  const onAddClick = useCallback(\n    () => createDialog({\n      id: 'modal-add-new-commercial-reference',\n      Component: NewCommercialReferenceModal,\n      props: {\n        onSubmit (commercialReference) {\n          formRef.current.setFieldValue('additionalInformation.commercialReferences', (old) => [...old, commercialReference])\n        }\n      }\n    }),\n    [createDialog, formRef]\n  )\n\n  const onEditClick = useCallback(\n    (_, row) => createDialog({\n      id: 'modal-edit-commercial-reference',\n      Component: NewCommercialReferenceModal,\n      props: {\n        commercialReference: row,\n        onSubmit (commercialReference) {\n          formRef.current.setFieldValue(\n            'additionalInformation.commercialReferences',\n            (old) => map(old, (item, index) => index === row.tableData.id ? { id: row.id, ...commercialReference } : item)\n          )\n        }\n      }\n    }),\n    [createDialog, formRef]\n  )\n\n  const onDeleteClick = useCallback(\n    (_, row) => createDialog({\n      id: 'modal-delete-commercial-reference',\n      Component: ConfirmModal,\n      props: {\n        onConfirm () {\n          formRef.current.setFieldValue(\n            'additionalInformation.commercialReferences',\n            (old) => filter(old, (item, index) => index !== row.tableData.id)\n          )\n        }\n      }\n    }),\n    [createDialog, formRef]\n  )\n\n  return (\n    <>\n      <DataTable\n        options={ { search: false } }\n        data={ commercialReferences }\n        columns={ columns }\n        title={ t('commercial reference', { howMany: 2 }) }\n        titleProps={ { variant: 'h6' } }\n        addTitle={ t('add new {this}', {\n          this: t('commercial reference', { howMany: 1 }),\n          gender: 'female'\n        }) }\n        minimalistToolbar\n        onAddClick={ !disabled && onAddClick }\n        onEditClick={ !disabled && onEditClick }\n        onDeleteClick={ !disabled && onDeleteClick }\n      />\n      <InputHidden\n        name=\"commercialReferences\"\n        showError\n        onValueChange={ setCommercialReferences }\n      />\n    </>\n  )\n}\n\nCommercialReferencesTable.propTypes = {\n  formRef: PropTypes.any.isRequired,\n  disabled: PropTypes.bool.isRequired\n}\n\nexport default CommercialReferencesTable\n"]},"metadata":{},"sourceType":"module"}