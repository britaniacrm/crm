{"ast":null,"code":"var _jsxFileName = \"/home/rafael/Documentos/britania/COM-front/packages/web/src/modules/vpc/screens/Vpc/Vpc.js\";\nimport React, { useRef, useCallback, useMemo, useState } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { useHistory, useLocation } from 'react-router-dom';\nimport { chain } from 'lodash';\nimport forEach from 'lodash/forEach';\nimport isEmpty from 'lodash/isEmpty';\nimport Grid from '@material-ui/core/Grid';\nimport Tab from '@material-ui/core/Tab';\nimport { useDialog } from '@britania-crm/dialog';\nimport { useFormEffect } from '@britania-crm/forms';\nimport vpcSchema, { INITIAL_VALUES } from '@britania-crm/forms/schemas/vpc/vpc.schema';\nimport I18n, { useT } from '@britania-crm/i18n';\nimport { vpc as vpcRoutes } from '@britania-crm/services/apis/crmApi/resources/routes';\nimport useCrmApi from '@britania-crm/services/hooks/useCrmApi';\nimport { VpcActions } from '@britania-crm/stores/vpc';\nimport { formatBackDateTimeToBackDateFormat, formatBackDateToIsoFormat } from '@britania-crm/utils/date';\nimport { trimMask } from '@britania-crm/utils/formatters';\nimport Button from '@britania-crm/web-components/Button';\nimport Form from '@britania-crm/web-components/Form';\nimport CircularLoader from '@britania-crm/web-components/Loader/CircularLoader';\nimport ConfirmModal from '@britania-crm/web-components/Modal/ConfirmModal';\nimport Tabs from '@britania-crm/web-components/Tabs';\nimport { useRoutes } from '@britania-crm/web-src/routes/authenticated.routes';\nimport useStyles from './styles';\nimport VpcAttachments from './tabs/vpcAttachments/VpcAttachments';\nimport VpcData from './tabs/vpcData/VpcData';\nimport VpcNd from './tabs/vpcNd/VpcNd';\nimport VpcOrders from './tabs/vpcOrders/VpcOrders';\nimport VpcProducts from './tabs/vpcProducts/VpcProducts';\n\nconst Vpc = () => {\n  var _state$params2;\n\n  const t = useT();\n  const classes = useStyles();\n  const {\n    routes,\n    currentRoute,\n    currentRoutePermissions\n  } = useRoutes();\n  const history = useHistory();\n  const {\n    state\n  } = useLocation();\n  const dispatch = useDispatch();\n  const {\n    createDialog\n  } = useDialog();\n  const idVpc = useMemo(() => {\n    var _state$params;\n\n    return state === null || state === void 0 ? void 0 : (_state$params = state.params) === null || _state$params === void 0 ? void 0 : _state$params.id;\n  }, [state]);\n  const [deploymentDate, setDeploymentDate] = useState('');\n  const [loader, setLoader] = useState(false);\n  const formRef = useRef(null);\n  const {\n    data: vpcFromApi,\n    loading: loadingVpcFromApi\n  } = useCrmApi((state === null || state === void 0 ? void 0 : (_state$params2 = state.params) === null || _state$params2 === void 0 ? void 0 : _state$params2.id) ? [vpcRoutes.getOne.replace(':vpcId', idVpc), state] : null, null, {\n    revalidateOnFocus: false\n  });\n  const mode = useMemo(() => {\n    var _routes$viewVpc, _routes$newVpc, _routes$editVpc;\n\n    switch (currentRoute.path) {\n      case (_routes$viewVpc = routes.viewVpc) === null || _routes$viewVpc === void 0 ? void 0 : _routes$viewVpc.path:\n        return 'view';\n\n      case (_routes$newVpc = routes.newVpc) === null || _routes$newVpc === void 0 ? void 0 : _routes$newVpc.path:\n        return 'create';\n\n      case (_routes$editVpc = routes.editVpc) === null || _routes$editVpc === void 0 ? void 0 : _routes$editVpc.path:\n        return 'edit';\n\n      default:\n        return 'view';\n    }\n  }, [currentRoute, routes]);\n  const disabled = useMemo(() => mode === 'view', [mode]);\n  const loading = useMemo(() => loadingVpcFromApi || loader, [loadingVpcFromApi, loader]);\n  const tabs = useMemo(() => [/*#__PURE__*/React.createElement(Tab, {\n    key: 1,\n    label: t('vpc data'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Tab, {\n    key: 2,\n    label: t('order', {\n      howMany: 2\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Tab, {\n    key: 3,\n    label: t('product', {\n      howMany: 2\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Tab, {\n    key: 4,\n    label: t('nd'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Tab, {\n    key: 5,\n    label: t('attachments', {\n      howMany: 1\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }\n  })], [t]);\n  const tabsContent = useMemo(() => [/*#__PURE__*/React.createElement(VpcData, {\n    key: 1,\n    disabled: disabled || loading,\n    formRef: formRef,\n    permissions: currentRoutePermissions.INCLUIR || currentRoutePermissions.EDITAR,\n    workflowTaskInProgress: !isEmpty(vpcFromApi) && !isEmpty(vpcFromApi.workflowTaskInProgress) ? vpcFromApi.workflowTaskInProgress : null,\n    id: idVpc,\n    deploymentDate: deploymentDate,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(VpcOrders, {\n    key: 2,\n    disabled: disabled,\n    formRef: formRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(VpcProducts, {\n    key: 3,\n    disabled: disabled,\n    formRef: formRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(VpcNd, {\n    key: 4,\n    disabled: disabled,\n    formRef: formRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(VpcAttachments, {\n    key: 5,\n    disabled: disabled,\n    formRef: formRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 7\n    }\n  })], [currentRoutePermissions.EDITAR, currentRoutePermissions.INCLUIR, deploymentDate, disabled, idVpc, loading, vpcFromApi]);\n  const handleSetEdit = useCallback(() => history.replace(routes.editVpc.path, {\n    params: {\n      id: idVpc\n    }\n  }), [history, idVpc, routes]);\n  const formatterLinesFamilies = useCallback(values => {\n    const linesFamilies = [];\n    forEach(values === null || values === void 0 ? void 0 : values.linesFamilies, ({\n      family,\n      lineCode,\n      lineDescription\n    }) => forEach(family, item => linesFamilies.push({\n      lineCode,\n      lineDescription,\n      ...item\n    })));\n    return linesFamilies;\n  }, []);\n  const callBackOnSuccess = useCallback(() => {\n    history.push(routes.vpc.path);\n    setLoader(false);\n  }, [history, routes]);\n  const callBackOnError = useCallback(error => {\n    setLoader(false);\n    formRef.current.setSubmitError(error);\n  }, []);\n  const payload = useCallback(values => {\n    var _values$parentCompany, _values$parentCompany2, _values$approverCode, _values$approverCode2, _values$approverCode3, _values$approverCode4;\n\n    return { ...values,\n      bankCnpj: trimMask(values.bankCnpj),\n      value: Number(values === null || values === void 0 ? void 0 : values.value),\n      parentCompanyCode: (_values$parentCompany = values.parentCompany) === null || _values$parentCompany === void 0 ? void 0 : _values$parentCompany.parentCompanyCode,\n      parentCompanyName: (_values$parentCompany2 = values.parentCompany) === null || _values$parentCompany2 === void 0 ? void 0 : _values$parentCompany2.parentCompanyName,\n      bank: values.label,\n      linesFamilies: formatterLinesFamilies(values),\n      startDate: formatBackDateToIsoFormat(values.period.from, 0),\n      endDate: formatBackDateToIsoFormat(values.period.to, 0),\n      approverCode: ((_values$approverCode = values.approverCode) === null || _values$approverCode === void 0 ? void 0 : _values$approverCode.code) ? (_values$approverCode2 = values.approverCode) === null || _values$approverCode2 === void 0 ? void 0 : _values$approverCode2.code : '',\n      approverDescription: ((_values$approverCode3 = values.approverCode) === null || _values$approverCode3 === void 0 ? void 0 : _values$approverCode3.description) ? (_values$approverCode4 = values.approverCode) === null || _values$approverCode4 === void 0 ? void 0 : _values$approverCode4.description : '',\n      directorshipCode: values.directorshipCode ? values.directorshipCode : null\n    };\n  }, [formatterLinesFamilies]);\n  const handleSubmit = useCallback(values => {\n    if (mode === 'create') {\n      dispatch(VpcActions.saveVpc(payload(values), true, callBackOnSuccess, callBackOnError));\n    } else if (mode === 'edit') {\n      dispatch(VpcActions.editVpc(idVpc, payload(values), true, callBackOnSuccess, callBackOnError));\n    }\n  }, [callBackOnError, callBackOnSuccess, dispatch, idVpc, mode, payload]);\n  const handleSave = useCallback(() => {\n    setLoader(true);\n    const values = formRef.current.getData();\n\n    if (mode === 'create') {\n      dispatch(VpcActions.saveVpc(payload(values), false, callBackOnSuccess, callBackOnError));\n    } else if (mode === 'edit') {\n      dispatch(VpcActions.editVpc(idVpc, payload(values), false, callBackOnSuccess, callBackOnError));\n    }\n  }, [callBackOnError, callBackOnSuccess, dispatch, idVpc, mode, payload]);\n  const handleConfirmCancel = useCallback(() => {\n    createDialog({\n      id: 'confirm-cancel',\n      Component: ConfirmModal,\n      props: {\n        onConfirm: () => history.push(routes.vpc.path),\n        text: mode === 'create' ? t('Do you want to cancel the registration?') : t('Do you want to cancel editing?')\n      }\n    });\n  }, [createDialog, history, mode, routes, t]);\n  useFormEffect(() => {\n    if (!isEmpty(vpcFromApi)) {\n      var _vpcFromApi$userCreat;\n\n      formRef.current.setData({ ...vpcFromApi,\n        status: vpcFromApi === null || vpcFromApi === void 0 ? void 0 : vpcFromApi.active,\n        approverCode: {\n          code: vpcFromApi === null || vpcFromApi === void 0 ? void 0 : vpcFromApi.approverCode,\n          description: vpcFromApi === null || vpcFromApi === void 0 ? void 0 : vpcFromApi.approverDescription\n        },\n        parentCompany: {\n          parentCompanyCode: vpcFromApi === null || vpcFromApi === void 0 ? void 0 : vpcFromApi.parentCompanyCode,\n          parentCompanyName: vpcFromApi === null || vpcFromApi === void 0 ? void 0 : vpcFromApi.parentCompanyName,\n          cnpj: vpcFromApi.cnpj,\n          companyName: vpcFromApi === null || vpcFromApi === void 0 ? void 0 : vpcFromApi.companyName\n        },\n        responsible: vpcFromApi === null || vpcFromApi === void 0 ? void 0 : (_vpcFromApi$userCreat = vpcFromApi.userCreated) === null || _vpcFromApi$userCreat === void 0 ? void 0 : _vpcFromApi$userCreat.username,\n        parentCompanyCode: {\n          parentCompanyCode: vpcFromApi === null || vpcFromApi === void 0 ? void 0 : vpcFromApi.parentCompanyCode,\n          parentCompany: vpcFromApi === null || vpcFromApi === void 0 ? void 0 : vpcFromApi.parentCompanyName,\n          cnpj: vpcFromApi.cnpj,\n          companyName: vpcFromApi === null || vpcFromApi === void 0 ? void 0 : vpcFromApi.companyName\n        },\n        period: {\n          from: formatBackDateTimeToBackDateFormat(vpcFromApi === null || vpcFromApi === void 0 ? void 0 : vpcFromApi.startDate),\n          to: formatBackDateTimeToBackDateFormat(vpcFromApi === null || vpcFromApi === void 0 ? void 0 : vpcFromApi.endDate)\n        },\n        bank: {\n          label: vpcFromApi.bank\n        },\n        linesFamilies: chain(vpcFromApi === null || vpcFromApi === void 0 ? void 0 : vpcFromApi.linesFamilies).groupBy('lineCode').map((value, key) => ({\n          lineCode: Number(key),\n          lineDescription: value[0].lineDescription,\n          family: value\n        })).value()\n      });\n      setDeploymentDate((vpcFromApi === null || vpcFromApi === void 0 ? void 0 : vpcFromApi.deploymentDate) ? formatBackDateTimeToBackDateFormat(vpcFromApi === null || vpcFromApi === void 0 ? void 0 : vpcFromApi.deploymentDate) : '');\n    }\n  }, [vpcFromApi]);\n  return /*#__PURE__*/React.createElement(Form, {\n    ref: formRef,\n    schemaConstructor: vpcSchema,\n    defaultValues: INITIAL_VALUES,\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Tabs, {\n    tabs: tabs,\n    tabsContent: tabsContent,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 7\n    }\n  }, loading && /*#__PURE__*/React.createElement(CircularLoader, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 22\n    }\n  }), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    className: classes.buttons,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 259,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 11\n    }\n  }, mode !== 'view' && /*#__PURE__*/React.createElement(I18n, {\n    as: Button,\n    className: classes.resetBtn,\n    variant: \"text\",\n    color: \"secondary\",\n    type: \"reset\",\n    onClick: () => formRef.current.reset(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 15\n    }\n  }, \"clean\")), /*#__PURE__*/React.createElement(Grid, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 274,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(I18n, {\n    as: Button,\n    color: \"secondary\",\n    variant: \"outlined\",\n    onClick: handleConfirmCancel,\n    className: classes.btnCancel,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 275,\n      columnNumber: 13\n    }\n  }, \"cancel\"), mode !== 'view' ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(I18n, {\n    as: Button,\n    onClick: handleSave,\n    color: \"secondary\",\n    className: classes.btnSave,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 285,\n      columnNumber: 17\n    }\n  }, \"save\"), /*#__PURE__*/React.createElement(I18n, {\n    as: Button,\n    onClick: () => formRef.current.submit(),\n    color: \"secondary\",\n    className: classes.btnSave,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 293,\n      columnNumber: 17\n    }\n  }, mode === 'create' ? 'finish registration' : 'request update')) : /*#__PURE__*/React.createElement(I18n, {\n    as: Button,\n    onClick: handleSetEdit,\n    color: \"secondary\",\n    className: classes.btnSave,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 303,\n      columnNumber: 15\n    }\n  }, \"edit\")))));\n};\n\nexport default Vpc;","map":{"version":3,"sources":["/home/rafael/Documentos/britania/COM-front/packages/web/src/modules/vpc/screens/Vpc/Vpc.js"],"names":["React","useRef","useCallback","useMemo","useState","useDispatch","useHistory","useLocation","chain","forEach","isEmpty","Grid","Tab","useDialog","useFormEffect","vpcSchema","INITIAL_VALUES","I18n","useT","vpc","vpcRoutes","useCrmApi","VpcActions","formatBackDateTimeToBackDateFormat","formatBackDateToIsoFormat","trimMask","Button","Form","CircularLoader","ConfirmModal","Tabs","useRoutes","useStyles","VpcAttachments","VpcData","VpcNd","VpcOrders","VpcProducts","Vpc","t","classes","routes","currentRoute","currentRoutePermissions","history","state","dispatch","createDialog","idVpc","params","id","deploymentDate","setDeploymentDate","loader","setLoader","formRef","data","vpcFromApi","loading","loadingVpcFromApi","getOne","replace","revalidateOnFocus","mode","path","viewVpc","newVpc","editVpc","disabled","tabs","howMany","tabsContent","INCLUIR","EDITAR","workflowTaskInProgress","handleSetEdit","formatterLinesFamilies","values","linesFamilies","family","lineCode","lineDescription","item","push","callBackOnSuccess","callBackOnError","error","current","setSubmitError","payload","bankCnpj","value","Number","parentCompanyCode","parentCompany","parentCompanyName","bank","label","startDate","period","from","endDate","to","approverCode","code","approverDescription","description","directorshipCode","handleSubmit","saveVpc","handleSave","getData","handleConfirmCancel","Component","props","onConfirm","text","setData","status","active","cnpj","companyName","responsible","userCreated","username","groupBy","map","key","buttons","resetBtn","reset","btnCancel","btnSave","submit"],"mappings":"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","sourcesContent":["import React, {\n  useRef,\n  useCallback,\n  useMemo,\n  useState\n} from 'react'\nimport { useDispatch } from 'react-redux'\nimport {\n  useHistory,\n  useLocation\n} from 'react-router-dom'\n\nimport { chain } from 'lodash'\nimport forEach from 'lodash/forEach'\nimport isEmpty from 'lodash/isEmpty'\n\nimport Grid from '@material-ui/core/Grid'\nimport Tab from '@material-ui/core/Tab'\n\nimport { useDialog } from '@britania-crm/dialog'\nimport { useFormEffect } from '@britania-crm/forms'\nimport vpcSchema, { INITIAL_VALUES } from '@britania-crm/forms/schemas/vpc/vpc.schema'\nimport I18n, { useT } from '@britania-crm/i18n'\nimport { vpc as vpcRoutes } from '@britania-crm/services/apis/crmApi/resources/routes'\nimport useCrmApi from '@britania-crm/services/hooks/useCrmApi'\nimport { VpcActions } from '@britania-crm/stores/vpc'\nimport {\n  formatBackDateTimeToBackDateFormat,\n  formatBackDateToIsoFormat\n} from '@britania-crm/utils/date'\nimport { trimMask } from '@britania-crm/utils/formatters'\nimport Button from '@britania-crm/web-components/Button'\nimport Form from '@britania-crm/web-components/Form'\nimport CircularLoader from '@britania-crm/web-components/Loader/CircularLoader'\nimport ConfirmModal from '@britania-crm/web-components/Modal/ConfirmModal'\nimport Tabs from '@britania-crm/web-components/Tabs'\nimport { useRoutes } from '@britania-crm/web-src/routes/authenticated.routes'\n\nimport useStyles from './styles'\nimport VpcAttachments from './tabs/vpcAttachments/VpcAttachments'\nimport VpcData from './tabs/vpcData/VpcData'\nimport VpcNd from './tabs/vpcNd/VpcNd'\nimport VpcOrders from './tabs/vpcOrders/VpcOrders'\nimport VpcProducts from './tabs/vpcProducts/VpcProducts'\n\nconst Vpc = () => {\n  const t = useT()\n  const classes = useStyles()\n  const {\n    routes, currentRoute, currentRoutePermissions\n  } = useRoutes()\n  const history = useHistory()\n  const { state } = useLocation()\n  const dispatch = useDispatch()\n  const { createDialog } = useDialog()\n  const idVpc = useMemo(() => state?.params?.id, [state])\n\n  const [deploymentDate, setDeploymentDate] = useState('')\n  const [loader, setLoader] = useState(false)\n\n  const formRef = useRef(null)\n\n  const { data: vpcFromApi, loading: loadingVpcFromApi } = useCrmApi(state?.params?.id ? [vpcRoutes.getOne.replace(':vpcId', idVpc), state] : null, null, { revalidateOnFocus: false })\n\n  const mode = useMemo(\n    () => {\n      switch (currentRoute.path) {\n        case routes.viewVpc?.path: return 'view'\n        case routes.newVpc?.path: return 'create'\n        case routes.editVpc?.path: return 'edit'\n        default: return 'view'\n      }\n    },\n    [currentRoute, routes]\n  )\n\n  const disabled = useMemo(() => mode === 'view', [mode])\n\n  const loading = useMemo(\n    () => loadingVpcFromApi || loader,\n    [loadingVpcFromApi, loader]\n  )\n\n  const tabs = useMemo(\n    () => [\n      <Tab key={ 1 } label={ t('vpc data') }/>,\n      <Tab key={ 2 } label={ t('order', { howMany: 2 }) }/>,\n      <Tab key={ 3 } label={ t('product', { howMany: 2 }) }/>,\n      <Tab key={ 4 } label={ t('nd') } />,\n      <Tab key={ 5 } label={ t('attachments', { howMany: 1 }) } />\n    ],\n    [t]\n  )\n\n  const tabsContent = useMemo(\n    () => [\n      <VpcData\n        key={ 1 }\n        disabled={ disabled || loading }\n        formRef={ formRef }\n        permissions={ currentRoutePermissions.INCLUIR || currentRoutePermissions.EDITAR }\n        workflowTaskInProgress={ !isEmpty(vpcFromApi) && !isEmpty(vpcFromApi.workflowTaskInProgress) ? vpcFromApi.workflowTaskInProgress : null }\n        id={ idVpc }\n        deploymentDate={ deploymentDate }\n      />,\n      <VpcOrders key={ 2 } disabled={ disabled } formRef={ formRef } />,\n      <VpcProducts key={ 3 } disabled={ disabled } formRef={ formRef } />,\n      <VpcNd key={ 4 } disabled={ disabled } formRef={ formRef } />,\n      <VpcAttachments key={ 5 } disabled={ disabled } formRef={ formRef } />\n    ],\n    [currentRoutePermissions.EDITAR, currentRoutePermissions.INCLUIR, deploymentDate, disabled, idVpc, loading, vpcFromApi]\n  )\n\n  const handleSetEdit = useCallback(\n    () =>\n      history.replace(routes.editVpc.path, { params: { id: idVpc } }),\n    [history, idVpc, routes]\n  )\n\n  const formatterLinesFamilies = useCallback(\n    (values) => {\n      const linesFamilies = []\n\n      forEach(values?.linesFamilies,\n        ({\n          family, lineCode, lineDescription\n        }) =>\n          forEach(family, (item) =>\n            linesFamilies.push({\n              lineCode, lineDescription, ...item\n            }))\n      )\n\n      return linesFamilies\n    }, [])\n\n  const callBackOnSuccess = useCallback(\n    () => {\n      history.push(routes.vpc.path)\n      setLoader(false)\n    },\n    [history, routes]\n  )\n\n  const callBackOnError = useCallback(\n    (error) => {\n      setLoader(false)\n      formRef.current.setSubmitError(error)\n    },\n    []\n  )\n\n  const payload = useCallback((values) => ({\n    ...values,\n    bankCnpj: trimMask(values.bankCnpj),\n    value: Number(values?.value),\n    parentCompanyCode: values.parentCompany?.parentCompanyCode,\n    parentCompanyName: values.parentCompany?.parentCompanyName,\n    bank: values.label,\n    linesFamilies: formatterLinesFamilies(values),\n    startDate: formatBackDateToIsoFormat(values.period.from, 0),\n    endDate: formatBackDateToIsoFormat(values.period.to, 0),\n    approverCode: values.approverCode?.code ? values.approverCode?.code : '',\n    approverDescription: values.approverCode?.description ? values.approverCode?.description : '',\n    directorshipCode: values.directorshipCode ? values.directorshipCode : null\n  }), [formatterLinesFamilies])\n\n  const handleSubmit = useCallback(\n    (values) => {\n      if (mode === 'create') {\n        dispatch(VpcActions.saveVpc(payload(values), true, callBackOnSuccess, callBackOnError))\n      } else if (mode === 'edit') {\n        dispatch(VpcActions.editVpc(idVpc, payload(values), true, callBackOnSuccess, callBackOnError))\n      }\n    },\n    [callBackOnError, callBackOnSuccess, dispatch, idVpc, mode, payload]\n  )\n\n  const handleSave = useCallback(\n    () => {\n      setLoader(true)\n      const values = formRef.current.getData()\n\n      if (mode === 'create') {\n        dispatch(VpcActions.saveVpc(payload(values), false, callBackOnSuccess, callBackOnError))\n      } else if (mode === 'edit') {\n        dispatch(VpcActions.editVpc(idVpc, payload(values), false, callBackOnSuccess, callBackOnError))\n      }\n    },\n    [callBackOnError, callBackOnSuccess, dispatch, idVpc, mode, payload]\n  )\n\n  const handleConfirmCancel = useCallback(\n    () => {\n      createDialog({\n        id: 'confirm-cancel',\n        Component: ConfirmModal,\n        props: {\n          onConfirm: () => history.push(routes.vpc.path),\n          text: mode === 'create'\n            ? t('Do you want to cancel the registration?')\n            : t('Do you want to cancel editing?')\n        }\n      })\n    },\n    [createDialog, history, mode, routes, t]\n  )\n\n  useFormEffect(\n    () => {\n      if (!isEmpty(vpcFromApi)) {\n        formRef.current.setData({\n          ...vpcFromApi,\n          status: vpcFromApi?.active,\n          approverCode: { code: vpcFromApi?.approverCode, description: vpcFromApi?.approverDescription },\n          parentCompany: {\n            parentCompanyCode: vpcFromApi?.parentCompanyCode,\n            parentCompanyName: vpcFromApi?.parentCompanyName,\n            cnpj: vpcFromApi.cnpj,\n            companyName: vpcFromApi?.companyName\n          },\n          responsible: vpcFromApi?.userCreated?.username,\n          parentCompanyCode: {\n            parentCompanyCode: vpcFromApi?.parentCompanyCode,\n            parentCompany: vpcFromApi?.parentCompanyName,\n            cnpj: vpcFromApi.cnpj,\n            companyName: vpcFromApi?.companyName\n          },\n          period: {\n            from: formatBackDateTimeToBackDateFormat(vpcFromApi?.startDate),\n            to: formatBackDateTimeToBackDateFormat(vpcFromApi?.endDate)\n          },\n          bank: { label: vpcFromApi.bank },\n          linesFamilies: chain(vpcFromApi?.linesFamilies)\n            .groupBy('lineCode')\n            .map((value, key) => ({\n              lineCode: Number(key), lineDescription: value[0].lineDescription, family: value\n            }))\n            .value()\n        })\n        setDeploymentDate(vpcFromApi?.deploymentDate ? formatBackDateTimeToBackDateFormat(vpcFromApi?.deploymentDate) : '')\n      }\n    },\n    [vpcFromApi]\n  )\n\n  return (\n    <Form\n      ref={ formRef }\n      schemaConstructor={ vpcSchema }\n      defaultValues={ INITIAL_VALUES }\n      onSubmit={ handleSubmit }\n    >\n      <Tabs\n        tabs={ tabs }\n        tabsContent={ tabsContent }\n      >\n        { loading && <CircularLoader/> }\n        <Grid item xs={ 12 } className={ classes.buttons }>\n          <Grid>\n            {mode !== 'view' && (\n              <I18n\n                as={ Button }\n                className={ classes.resetBtn }\n                variant=\"text\"\n                color=\"secondary\"\n                type=\"reset\"\n                onClick={ () => formRef.current.reset() }\n              >\n                clean\n              </I18n>\n            )}\n          </Grid>\n          <Grid>\n            <I18n as={ Button }\n              color=\"secondary\"\n              variant=\"outlined\"\n              onClick={ handleConfirmCancel }\n              className={ classes.btnCancel }\n            >\n            cancel\n            </I18n>\n            {mode !== 'view' ? (\n              <>\n                <I18n\n                  as={ Button }\n                  onClick={ handleSave }\n                  color=\"secondary\"\n                  className={ classes.btnSave }\n                >\n                save\n                </I18n>\n                <I18n\n                  as={ Button }\n                  onClick={ () => formRef.current.submit() }\n                  color=\"secondary\"\n                  className={ classes.btnSave }\n                >\n                  {mode === 'create' ? 'finish registration' : 'request update'}\n                </I18n>\n              </>\n            ) : (\n              <I18n\n                as={ Button }\n                onClick={ handleSetEdit }\n                color=\"secondary\"\n                className={ classes.btnSave }\n              >\n              edit\n              </I18n>\n            )}\n          </Grid>\n        </Grid>\n      </Tabs>\n    </Form>\n  )\n}\n\nexport default Vpc\n"]},"metadata":{},"sourceType":"module"}