{"ast":null,"code":"var _jsxFileName = \"/home/rafael/Documentos/britania/COM-front/packages/web/src/modules/users/screens/UsersListScreen/UsersListScreen.js\";\nimport React, { useCallback, useMemo } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { useHistory } from 'react-router-dom';\nimport map from 'lodash/map';\nimport { useDialog } from '@britania-crm/dialog';\nimport { useT } from '@britania-crm/i18n';\nimport { users as usersCrmRoutes } from '@britania-crm/services/apis/crmApi/resources/routes';\nimport useCrmApi from '@britania-crm/services/hooks/useCrmApi';\nimport { UsersActions } from '@britania-crm/stores/users';\nimport { formatPathToCloudStorageUrl } from '@britania-crm/utils/files';\nimport Avatar from '@britania-crm/web-components/Avatar';\nimport DataTable from '@britania-crm/web-components/DataTable';\nimport ConfirmModal from '@britania-crm/web-components/Modal/ConfirmModal';\nimport { useRoutes } from '@britania-crm/web-src/routes/authenticated.routes';\nimport NewUserModal from '../../modals/NewUserModal';\nimport UserProfileModal from '../../modals/UserProfileModal';\nimport { Container } from './styles';\n\nconst UsersListScreen = () => {\n  const t = useT();\n  const {\n    createDialog\n  } = useDialog();\n  const dispatch = useCallback(useDispatch(), []);\n  const history = useHistory();\n  const {\n    currentRoutePermissions\n  } = useRoutes();\n  const {\n    data,\n    loading,\n    mutate\n  } = useCrmApi(usersCrmRoutes.list);\n  const columns = useMemo(() => [{\n    sorting: false,\n    searchable: false,\n    width: 75,\n    align: 'center',\n    title: t('image', {\n      howMany: 1\n    }),\n    render: row => {\n      var _row$file;\n\n      return /*#__PURE__*/React.createElement(Avatar, {\n        index: row.id,\n        src: formatPathToCloudStorageUrl(row === null || row === void 0 ? void 0 : (_row$file = row.file) === null || _row$file === void 0 ? void 0 : _row$file.path),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 46,\n          columnNumber: 9\n        }\n      });\n    }\n  }, {\n    title: t('user', {\n      howMany: 1\n    }),\n    field: 'username',\n    width: 250\n  }, {\n    title: t('profile', {\n      howMany: 2\n    }),\n    field: 'userProfiles',\n    sorting: false,\n    searchable: false,\n    render: row => map(row.userProfiles, profile => profile.name).join(', ')\n  }], [t]);\n  const onRowClick = useCallback((event, row) => createDialog({\n    id: 'user-details-modal',\n    Component: UserProfileModal,\n    props: {\n      user: row,\n      currentRoutePermissions,\n      onSuccess: mutate\n    }\n  }), [createDialog, currentRoutePermissions, mutate]);\n  const onAddClick = useCallback(() => createDialog({\n    id: 'new-user-modal',\n    Component: NewUserModal,\n    props: {\n      onSuccess: mutate\n    }\n  }), [createDialog, mutate]);\n  const onEditClick = useCallback((event, row) => createDialog({\n    id: 'edit-user-modal',\n    Component: NewUserModal,\n    props: {\n      userId: row.id,\n      onSuccess: mutate\n    }\n  }), [createDialog, mutate]);\n  const onDeleteClick = useCallback((event, row) => createDialog({\n    id: 'delete-user-modal',\n    Component: ConfirmModal,\n    props: {\n      onConfirm() {\n        dispatch(UsersActions.removeUser(row.id, mutate));\n      }\n\n    }\n  }), [createDialog, dispatch, mutate]);\n  return /*#__PURE__*/React.createElement(Container, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(DataTable, {\n    data: data,\n    columns: columns,\n    loading: loading,\n    title: t('control of {this}', {\n      this: t('user', {\n        howMany: 2\n      })\n    }),\n    searchPlaceholder: t('search by {this}', {\n      this: t('name', {\n        howMany: 1\n      })\n    }),\n    addTitle: t('add new {this}', {\n      gender: 'male',\n      this: t('user', {\n        howMany: 1\n      })\n    }),\n    onAddClick: currentRoutePermissions.INCLUIR && onAddClick,\n    onEditClick: currentRoutePermissions.EDITAR && onEditClick,\n    onDeleteClick: currentRoutePermissions.EXCLUIR && onDeleteClick,\n    onRowClick: onRowClick,\n    onGoBack: history.goBack,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 7\n    }\n  }));\n};\n\nexport default UsersListScreen;","map":{"version":3,"sources":["/home/rafael/Documentos/britania/COM-front/packages/web/src/modules/users/screens/UsersListScreen/UsersListScreen.js"],"names":["React","useCallback","useMemo","useDispatch","useHistory","map","useDialog","useT","users","usersCrmRoutes","useCrmApi","UsersActions","formatPathToCloudStorageUrl","Avatar","DataTable","ConfirmModal","useRoutes","NewUserModal","UserProfileModal","Container","UsersListScreen","t","createDialog","dispatch","history","currentRoutePermissions","data","loading","mutate","list","columns","sorting","searchable","width","align","title","howMany","render","row","id","file","path","field","userProfiles","profile","name","join","onRowClick","event","Component","props","user","onSuccess","onAddClick","onEditClick","userId","onDeleteClick","onConfirm","removeUser","this","gender","INCLUIR","EDITAR","EXCLUIR","goBack"],"mappings":"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","sourcesContent":["import React, {\n  useCallback,\n  useMemo\n} from 'react'\nimport { useDispatch } from 'react-redux'\nimport { useHistory } from 'react-router-dom'\n\nimport map from 'lodash/map'\n\nimport { useDialog } from '@britania-crm/dialog'\nimport { useT } from '@britania-crm/i18n'\nimport { users as usersCrmRoutes } from '@britania-crm/services/apis/crmApi/resources/routes'\nimport useCrmApi from '@britania-crm/services/hooks/useCrmApi'\nimport { UsersActions } from '@britania-crm/stores/users'\nimport { formatPathToCloudStorageUrl } from '@britania-crm/utils/files'\nimport Avatar from '@britania-crm/web-components/Avatar'\nimport DataTable from '@britania-crm/web-components/DataTable'\nimport ConfirmModal from '@britania-crm/web-components/Modal/ConfirmModal'\nimport { useRoutes } from '@britania-crm/web-src/routes/authenticated.routes'\n\nimport NewUserModal from '../../modals/NewUserModal'\nimport UserProfileModal from '../../modals/UserProfileModal'\nimport { Container } from './styles'\n\nconst UsersListScreen = () => {\n  const t = useT()\n  const { createDialog } = useDialog()\n  const dispatch = useCallback(useDispatch(), [])\n  const history = useHistory()\n  const { currentRoutePermissions } = useRoutes()\n\n  const {\n    data,\n    loading,\n    mutate\n  } = useCrmApi(usersCrmRoutes.list)\n\n  const columns = useMemo(() => [\n    {\n      sorting: false,\n      searchable: false,\n      width: 75,\n      align: 'center',\n      title: t('image', { howMany: 1 }),\n      render: (row) => (\n        <Avatar\n          index={ row.id }\n          src={ formatPathToCloudStorageUrl(row?.file?.path) }\n        />\n      )\n    },\n    {\n      title: t('user', { howMany: 1 }),\n      field: 'username',\n      width: 250\n    },\n    {\n      title: t('profile', { howMany: 2 }),\n      field: 'userProfiles',\n      sorting: false,\n      searchable: false,\n      render: (row) => map(row.userProfiles, (profile) => profile.name).join(', ')\n    }\n  ], [t])\n\n  const onRowClick = useCallback(\n    (event, row) => createDialog({\n      id: 'user-details-modal',\n      Component: UserProfileModal,\n      props: {\n        user: row,\n        currentRoutePermissions,\n        onSuccess: mutate\n      }\n    }),\n    [createDialog, currentRoutePermissions, mutate]\n  )\n\n  const onAddClick = useCallback(\n    () => createDialog({\n      id: 'new-user-modal',\n      Component: NewUserModal,\n      props: { onSuccess: mutate }\n    }),\n    [createDialog, mutate]\n  )\n\n  const onEditClick = useCallback(\n    (event, row) => createDialog({\n      id: 'edit-user-modal',\n      Component: NewUserModal,\n      props: {\n        userId: row.id,\n        onSuccess: mutate\n      }\n    }),\n    [createDialog, mutate]\n  )\n\n  const onDeleteClick = useCallback(\n    (event, row) => createDialog({\n      id: 'delete-user-modal',\n      Component: ConfirmModal,\n      props: {\n        onConfirm () {\n          dispatch(UsersActions.removeUser(row.id, mutate))\n        }\n      }\n    }),\n    [createDialog, dispatch, mutate]\n  )\n\n  return (\n    <Container>\n      <DataTable\n        data={ data }\n        columns={ columns }\n        loading={ loading }\n        title={ t('control of {this}', { this: t('user', { howMany: 2 }) }) }\n        searchPlaceholder={ t('search by {this}', { this: t('name', { howMany: 1 }) }) }\n        addTitle={ t('add new {this}', { gender: 'male', this: t('user', { howMany: 1 }) }) }\n        onAddClick={ currentRoutePermissions.INCLUIR && onAddClick }\n        onEditClick={ currentRoutePermissions.EDITAR && onEditClick }\n        onDeleteClick={ currentRoutePermissions.EXCLUIR && onDeleteClick }\n        onRowClick={ onRowClick }\n        onGoBack={ history.goBack }\n      />\n    </Container>\n  )\n}\n\nexport default UsersListScreen\n"]},"metadata":{},"sourceType":"module"}