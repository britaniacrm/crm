{"ast":null,"code":"var _jsxFileName = \"/home/rafael/Documentos/britania/COM-front/packages/web/src/modules/vpc/modals/NewOrderModal/NewOrderModal.js\";\nimport React, { useCallback, useRef, useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport debounce from 'lodash/debounce';\nimport isEmpty from 'lodash/isEmpty';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Grid from '@material-ui/core/Grid';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport { useFormEffect } from '@britania-crm/forms';\nimport vpcOrderSchema, { INITIAL_VALUES } from '@britania-crm/forms/schemas/vpc/vpc.order.schema';\nimport I18n, { useT } from '@britania-crm/i18n';\nimport { vpc as vpcRoutes } from '@britania-crm/services/apis/crmApi/resources/routes';\nimport useCrmApi from '@britania-crm/services/hooks/useCrmApi';\nimport { useSnackbar } from '@britania-crm/snackbar';\nimport Button from '@britania-crm/web-components/Button';\nimport Form from '@britania-crm/web-components/Form';\nimport InputMoney from '@britania-crm/web-components/InputMoney';\nimport InputNumber from '@britania-crm/web-components/InputNumber';\nimport InputText from '@britania-crm/web-components/InputText';\nimport Modal from '@britania-crm/web-components/Modal';\nimport useStyles from '../styles';\n\nconst NewOrderModal = props => {\n  const {\n    id,\n    open,\n    handleClose,\n    onSubmit\n  } = props;\n  const t = useT();\n  const formRef = useRef(null);\n  const classes = useStyles();\n  const snackbar = useSnackbar();\n  const [requestNumber, setRequestNumber] = useState(INITIAL_VALUES.requestNumber);\n  const {\n    data,\n    loading\n  } = useCrmApi(requestNumber ? [vpcRoutes.getRequestByNumber.replace(':requestNumber', requestNumber), requestNumber] : null);\n  const handleChangeRequestNumber = useCallback(debounce(setRequestNumber, 1000), []);\n  const handleSubmit = useCallback(values => {\n    onSubmit(values);\n    handleClose();\n  }, [handleClose, onSubmit]);\n  useFormEffect(() => {\n    if (!isEmpty(data) && (data === null || data === void 0 ? void 0 : data.code)) {\n      formRef.current.setData({\n        requestNumber,\n        establishmentCode: data === null || data === void 0 ? void 0 : data.code,\n        establishmentName: data === null || data === void 0 ? void 0 : data.name,\n        value: data === null || data === void 0 ? void 0 : data.value\n      });\n    }\n  }, [data, requestNumber]);\n  useEffect(() => {\n    if (!isEmpty(data) && !(data === null || data === void 0 ? void 0 : data.code)) {\n      snackbar.error(t('no request was found for the given number!'));\n      formRef.current.setData(old => ({ ...INITIAL_VALUES,\n        requestNumber: old.requestNumber\n      }));\n    }\n  }, [data, requestNumber, snackbar, t]);\n  return /*#__PURE__*/React.createElement(Modal, {\n    id: id,\n    open: open,\n    title: t('new order'),\n    variant: \"space\",\n    maxWidth: \"lg\",\n    fullWidth: true,\n    FooterComponent: () => /*#__PURE__*/React.createElement(Grid, {\n      item: true,\n      xs: 12,\n      className: classes.buttons,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Grid, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(I18n, {\n      as: Button,\n      onClick: () => formRef.current.reset(),\n      variant: \"text\",\n      color: \"secondary\",\n      type: \"reset\",\n      className: classes.resetBtn,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 13\n      }\n    }, \"clean\")), /*#__PURE__*/React.createElement(Grid, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(I18n, {\n      as: Button,\n      onClick: handleClose,\n      color: \"secondary\",\n      variant: \"outlined\",\n      className: classes.btnCancel,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 13\n      }\n    }, \"cancel\"), /*#__PURE__*/React.createElement(I18n, {\n      as: Button,\n      onClick: () => formRef.current.submit(),\n      color: \"secondary\",\n      className: classes.btnSave,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 13\n      }\n    }, \"save\"))),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Form, {\n    ref: formRef,\n    onSubmit: handleSubmit,\n    schemaConstructor: vpcOrderSchema,\n    defaultValues: INITIAL_VALUES,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    spacing: 1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    md: 3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(InputNumber, {\n    label: t('order number'),\n    name: \"requestNumber\",\n    onValueChange: handleChangeRequestNumber,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    md: 3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(InputText, {\n    label: t('establishment code'),\n    name: \"establishmentCode\",\n    disabled: true,\n    InputProps: {\n      endAdornment: /*#__PURE__*/React.createElement(InputAdornment, {\n        position: \"end\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 19\n        }\n      }, loading && /*#__PURE__*/React.createElement(CircularProgress, {\n        color: \"inherit\",\n        size: 18,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 23\n        }\n      }))\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    md: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(InputText, {\n    label: t('name of the establishment'),\n    name: \"establishmentName\",\n    disabled: true,\n    InputProps: {\n      endAdornment: /*#__PURE__*/React.createElement(InputAdornment, {\n        position: \"end\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 19\n        }\n      }, loading && /*#__PURE__*/React.createElement(CircularProgress, {\n        color: \"inherit\",\n        size: 18,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 23\n        }\n      }))\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    md: 2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(InputMoney, {\n    label: t('value'),\n    name: \"value\",\n    disabled: true,\n    InputProps: {\n      endAdornment: /*#__PURE__*/React.createElement(InputAdornment, {\n        position: \"end\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 19\n        }\n      }, loading && /*#__PURE__*/React.createElement(CircularProgress, {\n        color: \"inherit\",\n        size: 18,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 23\n        }\n      }))\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 13\n    }\n  })))));\n};\n\nNewOrderModal.propTypes = {\n  id: PropTypes.string.isRequired,\n  open: PropTypes.bool.isRequired,\n  handleClose: PropTypes.func.isRequired,\n  onSubmit: PropTypes.func.isRequired\n};\nexport default NewOrderModal;","map":{"version":3,"sources":["/home/rafael/Documentos/britania/COM-front/packages/web/src/modules/vpc/modals/NewOrderModal/NewOrderModal.js"],"names":["React","useCallback","useRef","useState","useEffect","PropTypes","debounce","isEmpty","CircularProgress","Grid","InputAdornment","useFormEffect","vpcOrderSchema","INITIAL_VALUES","I18n","useT","vpc","vpcRoutes","useCrmApi","useSnackbar","Button","Form","InputMoney","InputNumber","InputText","Modal","useStyles","NewOrderModal","props","id","open","handleClose","onSubmit","t","formRef","classes","snackbar","requestNumber","setRequestNumber","data","loading","getRequestByNumber","replace","handleChangeRequestNumber","handleSubmit","values","code","current","setData","establishmentCode","establishmentName","name","value","error","old","buttons","reset","resetBtn","btnCancel","submit","btnSave","endAdornment","propTypes","string","isRequired","bool","func"],"mappings":"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","sourcesContent":["import React, {\n  useCallback,\n  useRef,\n  useState,\n  useEffect\n} from 'react'\n\nimport PropTypes from 'prop-types'\n\nimport debounce from 'lodash/debounce'\nimport isEmpty from 'lodash/isEmpty'\n\nimport CircularProgress from '@material-ui/core/CircularProgress'\nimport Grid from '@material-ui/core/Grid'\nimport InputAdornment from '@material-ui/core/InputAdornment'\n\nimport { useFormEffect } from '@britania-crm/forms'\nimport vpcOrderSchema, { INITIAL_VALUES } from '@britania-crm/forms/schemas/vpc/vpc.order.schema'\nimport I18n, { useT } from '@britania-crm/i18n'\nimport { vpc as vpcRoutes } from '@britania-crm/services/apis/crmApi/resources/routes'\nimport useCrmApi from '@britania-crm/services/hooks/useCrmApi'\nimport { useSnackbar } from '@britania-crm/snackbar'\nimport Button from '@britania-crm/web-components/Button'\nimport Form from '@britania-crm/web-components/Form'\nimport InputMoney from '@britania-crm/web-components/InputMoney'\nimport InputNumber from '@britania-crm/web-components/InputNumber'\nimport InputText from '@britania-crm/web-components/InputText'\nimport Modal from '@britania-crm/web-components/Modal'\n\nimport useStyles from '../styles'\n\nconst NewOrderModal = (props) => {\n  const {\n    id,\n    open,\n    handleClose,\n    onSubmit\n  } = props\n\n  const t = useT()\n  const formRef = useRef(null)\n  const classes = useStyles()\n  const snackbar = useSnackbar()\n\n  const [requestNumber, setRequestNumber] = useState(INITIAL_VALUES.requestNumber)\n\n  const { data, loading } = useCrmApi(\n    requestNumber\n      ? [vpcRoutes.getRequestByNumber.replace(':requestNumber', requestNumber), requestNumber]\n      : null\n  )\n\n  const handleChangeRequestNumber = useCallback(debounce(setRequestNumber, 1000), [])\n\n  const handleSubmit = useCallback(\n    (values) => {\n      onSubmit(values)\n      handleClose()\n    },\n    [handleClose, onSubmit]\n  )\n\n  useFormEffect(\n    () => {\n      if (!isEmpty(data) && data?.code) {\n        formRef.current.setData({\n          requestNumber,\n          establishmentCode: data?.code,\n          establishmentName: data?.name,\n          value: data?.value\n        })\n      }\n    },\n    [data, requestNumber]\n  )\n\n  useEffect(() => {\n    if (!isEmpty(data) && !data?.code) {\n      snackbar.error(t('no request was found for the given number!'))\n      formRef.current.setData((old) => ({\n        ...INITIAL_VALUES,\n        requestNumber: old.requestNumber\n      }))\n    }\n  }, [data, requestNumber, snackbar, t])\n\n  return (\n    <Modal\n      id={ id }\n      open={ open }\n      title={ t('new order') }\n      variant=\"space\"\n      maxWidth=\"lg\"\n      fullWidth\n      FooterComponent={ () => (\n        <Grid item xs={ 12 } className={ classes.buttons }>\n          <Grid>\n            <I18n as={ Button }\n              onClick={ () => formRef.current.reset() }\n              variant=\"text\"\n              color=\"secondary\"\n              type=\"reset\"\n              className={ classes.resetBtn }\n            >\n            clean\n            </I18n>\n          </Grid>\n          <Grid>\n            <I18n as={ Button }\n              onClick={ handleClose }\n              color=\"secondary\"\n              variant=\"outlined\"\n              className={ classes.btnCancel }\n            >\n            cancel\n            </I18n>\n            <I18n as={ Button }\n              onClick={ () => formRef.current.submit() }\n              color=\"secondary\"\n              className={ classes.btnSave }\n            >\n            save\n            </I18n>\n          </Grid>\n        </Grid>\n      ) }\n    >\n      <Form\n        ref={ formRef }\n        onSubmit={ handleSubmit }\n        schemaConstructor={ vpcOrderSchema }\n        defaultValues={ INITIAL_VALUES }\n      >\n        <Grid container spacing={ 1 }>\n          <Grid item xs={ 12 } md={ 3 }>\n            <InputNumber\n              label={ t('order number') }\n              name=\"requestNumber\"\n              onValueChange={ handleChangeRequestNumber }\n            />\n          </Grid>\n          <Grid item xs={ 12 } md={ 3 }>\n            <InputText\n              label={ t('establishment code') }\n              name=\"establishmentCode\"\n              disabled\n              InputProps={ {\n                endAdornment: (\n                  <InputAdornment position=\"end\">\n                    {loading && (\n                      <CircularProgress\n                        color=\"inherit\"\n                        size={ 18 }\n                      />\n                    ) }\n                  </InputAdornment>\n                )\n              } }\n            />\n          </Grid>\n          <Grid item xs={ 12 } md={ 4 }>\n            <InputText\n              label={ t('name of the establishment') }\n              name=\"establishmentName\"\n              disabled\n              InputProps={ {\n                endAdornment: (\n                  <InputAdornment position=\"end\">\n                    {loading && (\n                      <CircularProgress\n                        color=\"inherit\"\n                        size={ 18 }\n                      />\n                    ) }\n                  </InputAdornment>\n                )\n              } }\n            />\n          </Grid>\n          <Grid item xs={ 12 } md={ 2 }>\n            <InputMoney\n              label={ t('value') }\n              name=\"value\"\n              disabled\n              InputProps={ {\n                endAdornment: (\n                  <InputAdornment position=\"end\">\n                    {loading && (\n                      <CircularProgress\n                        color=\"inherit\"\n                        size={ 18 }\n                      />\n                    ) }\n                  </InputAdornment>\n                )\n              } }\n            />\n          </Grid>\n        </Grid>\n      </Form>\n    </Modal>\n  )\n}\n\nNewOrderModal.propTypes = {\n  id: PropTypes.string.isRequired,\n  open: PropTypes.bool.isRequired,\n  handleClose: PropTypes.func.isRequired,\n  onSubmit: PropTypes.func.isRequired\n}\n\nexport default NewOrderModal\n"]},"metadata":{},"sourceType":"module"}