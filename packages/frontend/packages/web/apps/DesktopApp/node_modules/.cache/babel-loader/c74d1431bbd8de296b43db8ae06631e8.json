{"ast":null,"code":"var _jsxFileName = \"/home/rafael/Documentos/britania/COM-front/packages/web/src/modules/profiles/modals/PermissionExceptionsModal/PermissionExceptionsModal.js\";\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport filter from 'lodash/filter';\nimport find from 'lodash/find';\nimport map from 'lodash/map';\nimport Grid from '@material-ui/core/Grid';\nimport permissionExceptionsSchema, { INITIAL_VALUES } from '@britania-crm/forms/schemas/profile/permissionExceptions.schema';\nimport I18n, { useT } from '@britania-crm/i18n';\nimport Badges from '@britania-crm/web-components/Badges';\nimport Button from '@britania-crm/web-components/Button';\nimport Form from '@britania-crm/web-components/Form';\nimport InputSelect from '@britania-crm/web-components/InputSelect';\nimport Modal from '@britania-crm/web-components/Modal';\nimport useStyles, { TitleItem } from '../styles';\n\nconst PermissionExceptionsModal = ({\n  id,\n  open,\n  handleClose,\n  permissions,\n  exceptionsList,\n  access,\n  onSave,\n  isEdit\n}) => {\n  const classes = useStyles();\n  const t = useT();\n  const formRef = useRef(null);\n  const [mounted, setMounted] = useState(false);\n  const filterOptions = useMemo(() => {\n    const existingAccess = map(exceptionsList, ({\n      access\n    }) => access);\n    return filter(access, item => !find(existingAccess, ({\n      id\n    }) => id === item.id));\n  }, [access, exceptionsList]);\n  const handleSubmit = useCallback(values => {\n    onSave({\n      access: find(access, item => item.id === values.accessId),\n      permission: values.permissions\n    });\n    handleClose();\n  }, [access, handleClose, onSave]);\n  useEffect(() => {\n    if (mounted && isEdit) {\n      var _access$;\n\n      formRef.current.setData({\n        permissions,\n        accessId: access === null || access === void 0 ? void 0 : (_access$ = access[0]) === null || _access$ === void 0 ? void 0 : _access$.id\n      });\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [isEdit, permissions, mounted]);\n  useEffect(() => {\n    if (mounted && !isEdit) {\n      var _filterOptions$;\n\n      formRef.current.setFieldValue('accessId', filterOptions === null || filterOptions === void 0 ? void 0 : (_filterOptions$ = filterOptions[0]) === null || _filterOptions$ === void 0 ? void 0 : _filterOptions$.id);\n    }\n  }, [filterOptions, isEdit, mounted]);\n  useEffect(() => {\n    setMounted(true);\n  }, []);\n  return /*#__PURE__*/React.createElement(Modal, {\n    id: id,\n    open: open,\n    title: t('permission exception'),\n    maxWidth: \"sm\",\n    fullWidth: true,\n    FooterComponent: () => /*#__PURE__*/React.createElement(Grid, {\n      container: true,\n      alignItems: \"center\",\n      justify: \"center\",\n      spacing: 2,\n      className: classes.buttons,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(I18n, {\n      as: Button,\n      color: \"secondary\",\n      onClick: handleClose,\n      size: \"small\",\n      variant: \"outlined\",\n      width: \"200px\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 11\n      }\n    }, \"cancel\"), /*#__PURE__*/React.createElement(I18n, {\n      as: Button,\n      color: \"secondary\",\n      onClick: () => formRef.current.submit(),\n      size: \"small\",\n      variant: \"contained\",\n      width: \"200px\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 11\n      }\n    }, \"save\")),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Form, {\n    ref: formRef,\n    schemaConstructor: permissionExceptionsSchema,\n    defaultValues: INITIAL_VALUES,\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    spacing: 2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 7,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(InputSelect, {\n    name: \"accessId\",\n    label: \"Menu para visualiza\\xE7\\xE3o Micro\",\n    options: filterOptions,\n    disabled: isEdit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    item: true,\n    xs: 12,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(I18n, {\n    as: TitleItem,\n    params: {\n      howMany: 2\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 15\n    }\n  }, \"permission\")), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Badges, {\n    name: \"permissions\",\n    options: permissions,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 15\n    }\n  }))))));\n};\n\nPermissionExceptionsModal.propTypes = {\n  handleClose: PropTypes.func,\n  id: PropTypes.string.isRequired,\n  open: PropTypes.bool.isRequired,\n  permissions: PropTypes.array,\n  access: PropTypes.array,\n  onSave: PropTypes.func,\n  isEdit: PropTypes.bool,\n  exceptionsList: PropTypes.array\n};\nPermissionExceptionsModal.defaultProps = {\n  access: [],\n  permissions: [],\n\n  onSave() {},\n\n  handleClose() {},\n\n  isEdit: false,\n  exceptionsList: []\n};\nexport default PermissionExceptionsModal;","map":{"version":3,"sources":["/home/rafael/Documentos/britania/COM-front/packages/web/src/modules/profiles/modals/PermissionExceptionsModal/PermissionExceptionsModal.js"],"names":["React","useCallback","useEffect","useMemo","useRef","useState","PropTypes","filter","find","map","Grid","permissionExceptionsSchema","INITIAL_VALUES","I18n","useT","Badges","Button","Form","InputSelect","Modal","useStyles","TitleItem","PermissionExceptionsModal","id","open","handleClose","permissions","exceptionsList","access","onSave","isEdit","classes","t","formRef","mounted","setMounted","filterOptions","existingAccess","item","handleSubmit","values","accessId","permission","current","setData","setFieldValue","buttons","submit","howMany","propTypes","func","string","isRequired","bool","array","defaultProps"],"mappings":"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","sourcesContent":["import React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState\n} from 'react'\n\nimport PropTypes from 'prop-types'\n\nimport filter from 'lodash/filter'\nimport find from 'lodash/find'\nimport map from 'lodash/map'\n\nimport Grid from '@material-ui/core/Grid'\n\nimport permissionExceptionsSchema, { INITIAL_VALUES } from '@britania-crm/forms/schemas/profile/permissionExceptions.schema'\nimport I18n, { useT } from '@britania-crm/i18n'\nimport Badges from '@britania-crm/web-components/Badges'\nimport Button from '@britania-crm/web-components/Button'\nimport Form from '@britania-crm/web-components/Form'\nimport InputSelect from '@britania-crm/web-components/InputSelect'\nimport Modal from '@britania-crm/web-components/Modal'\n\nimport useStyles, { TitleItem } from '../styles'\n\nconst PermissionExceptionsModal = ({\n  id,\n  open,\n  handleClose,\n  permissions,\n  exceptionsList,\n  access,\n  onSave,\n  isEdit\n}) => {\n  const classes = useStyles()\n  const t = useT()\n  const formRef = useRef(null)\n\n  const [mounted, setMounted] = useState(false)\n\n  const filterOptions = useMemo(\n    () => {\n      const existingAccess = map(exceptionsList, ({ access }) => access)\n      return filter(access, (item) => !find(existingAccess, ({ id }) => id === item.id))\n    },\n    [access, exceptionsList]\n  )\n\n  const handleSubmit = useCallback(\n    (values) => {\n      onSave({\n        access: find(access, (item) => (item.id === values.accessId)),\n        permission: values.permissions\n      })\n      handleClose()\n    },\n    [access, handleClose, onSave]\n  )\n\n  useEffect(() => {\n    if (mounted && isEdit) {\n      formRef.current.setData({\n        permissions,\n        accessId: access?.[0]?.id\n      })\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isEdit, permissions, mounted])\n\n  useEffect(() => {\n    if (mounted && !isEdit) {\n      formRef.current.setFieldValue('accessId', filterOptions?.[0]?.id)\n    }\n  }, [filterOptions, isEdit, mounted])\n\n  useEffect(() => {\n    setMounted(true)\n  }, [])\n\n  return (\n    <Modal\n      id={ id }\n      open={ open }\n      title={ t('permission exception') }\n      maxWidth=\"sm\"\n      fullWidth\n      FooterComponent={ () => (\n        <Grid container alignItems=\"center\" justify=\"center\" spacing={ 2 } className={ classes.buttons }>\n          <I18n as={ Button }\n            color=\"secondary\"\n            onClick={ handleClose }\n            size=\"small\"\n            variant=\"outlined\"\n            width=\"200px\"\n          >\n            cancel\n          </I18n>\n          <I18n as={ Button }\n            color=\"secondary\"\n            onClick={ () => formRef.current.submit() }\n            size=\"small\"\n            variant=\"contained\"\n            width=\"200px\"\n          >\n            save\n          </I18n>\n        </Grid>\n      ) }\n    >\n      <Form\n        ref={ formRef }\n        schemaConstructor={ permissionExceptionsSchema }\n        defaultValues={ INITIAL_VALUES }\n        onSubmit={ handleSubmit }\n      >\n        <Grid container spacing={ 2 }>\n          <Grid item xs={ 7 }>\n            <InputSelect\n              name=\"accessId\"\n              label=\"Menu para visualização Micro\"\n              options={ filterOptions }\n              disabled={ isEdit }\n            />\n          </Grid>\n          <Grid container item xs={ 12 }>\n            <Grid item >\n              <I18n as={ TitleItem } params={ { howMany: 2 } }>permission</I18n>\n            </Grid>\n            <Grid item >\n              <Badges\n                name=\"permissions\"\n                options={ permissions }\n              />\n            </Grid>\n          </Grid>\n        </Grid>\n      </Form>\n    </Modal>\n  )\n}\n\nPermissionExceptionsModal.propTypes = {\n  handleClose: PropTypes.func,\n  id: PropTypes.string.isRequired,\n  open: PropTypes.bool.isRequired,\n  permissions: PropTypes.array,\n  access: PropTypes.array,\n  onSave: PropTypes.func,\n  isEdit: PropTypes.bool,\n  exceptionsList: PropTypes.array\n}\n\nPermissionExceptionsModal.defaultProps = {\n  access: [],\n  permissions: [],\n  onSave () {},\n  handleClose () {},\n  isEdit: false,\n  exceptionsList: []\n}\n\nexport default PermissionExceptionsModal\n"]},"metadata":{},"sourceType":"module"}