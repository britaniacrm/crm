{"ast":null,"code":"var _jsxFileName = \"/home/rafael/Documentos/britania/COM-front/packages/web/src/modules/representative/screens/RepresentativeFormScreen/MainForm.js\";\nimport React, { useCallback, useMemo, useRef, useState, useEffect } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { useHistory, useLocation } from 'react-router-dom';\nimport isEmpty from 'lodash/isEmpty';\nimport Grid from '@material-ui/core/Grid';\nimport Tab from '@material-ui/core/Tab';\nimport { useFormEffect } from '@britania-crm/forms';\nimport representativeSchema, { INITIAL_VALUES } from '@britania-crm/forms/schemas/representative/representative.schema';\nimport I18n, { useT } from '@britania-crm/i18n';\nimport { representative as representativeCrmRoutes } from '@britania-crm/services/apis/crmApi/resources/routes';\nimport { searchStates } from '@britania-crm/services/apis/ibgeApi';\nimport useCrmApi from '@britania-crm/services/hooks/useCrmApi';\nimport { RepresentativeActions } from '@britania-crm/stores/representative';\nimport { formatBackDateTimeToBackDateFormat, formatFriendlyDateToBackFormat } from '@britania-crm/utils/date';\nimport { trimMask } from '@britania-crm/utils/formatters';\nimport Button from '@britania-crm/web-components/Button';\nimport Form from '@britania-crm/web-components/Form';\nimport { CircularLoader } from '@britania-crm/web-components/Loader';\nimport Tabs from '@britania-crm/web-components/Tabs';\nimport { useRoutes } from '@britania-crm/web-src/routes/authenticated.routes';\nimport Customer from './Customer';\nimport Representative from './Representative';\nimport useStyles from './styles';\n\nconst MainForm = () => {\n  const t = useT();\n  const classes = useStyles();\n  const {\n    routes\n  } = useRoutes();\n  const history = useHistory();\n  const dispatch = useCallback(useDispatch(), []);\n  const {\n    state\n  } = useLocation();\n  const formRef = useRef(null);\n  const [saveLoader, setSaveLoader] = useState(false);\n  const [concludeLoader, setConcludeLoader] = useState(false);\n  const [currentState, setCurrentState] = useState('');\n  const [stateOptions, setStateOptions] = useState([]);\n  const mode = useMemo(() => {\n    var _state$params;\n\n    return state === null || state === void 0 ? void 0 : (_state$params = state.params) === null || _state$params === void 0 ? void 0 : _state$params.mode;\n  }, [state]);\n  const modeView = useMemo(() => mode === 'view', [mode]);\n  const id = useMemo(() => {\n    var _state$params2;\n\n    return state === null || state === void 0 ? void 0 : (_state$params2 = state.params) === null || _state$params2 === void 0 ? void 0 : _state$params2.id;\n  }, [state.params.id]);\n  const {\n    data: representativeFromApi,\n    loading: getLoading\n  } = useCrmApi(id ? [representativeCrmRoutes.getOne.replace(':id', id), id] : null, null, {\n    revalidateOnFocus: false\n  });\n  const loading = useMemo(() => getLoading || saveLoader || concludeLoader, [concludeLoader, getLoading, saveLoader]);\n  const tabsOptions = useMemo(() => [/*#__PURE__*/React.createElement(Tab, {\n    key: 1,\n    label: t('representative', {\n      howMany: 1\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 5\n    }\n  }), /*#__PURE__*/React.createElement(Tab, {\n    key: 2,\n    label: t('registration Parameterization'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 5\n    }\n  })], [t]);\n  const getFieldAddress = useCallback(address => {\n    formRef.current.setData({\n      address: { ...address,\n        district: address.neighborhood\n      }\n    });\n  }, []);\n  const tabsContent = useMemo(() => [/*#__PURE__*/React.createElement(Representative, {\n    key: 1,\n    getFieldAddress: getFieldAddress,\n    setCurrentState: setCurrentState,\n    currentState: currentState,\n    disabled: modeView,\n    stateOptions: stateOptions,\n    formRef: formRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Customer, {\n    key: 2,\n    disabled: modeView,\n    formRef: formRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }\n  })], [currentState, getFieldAddress, modeView, stateOptions]);\n  const getStateOptions = useCallback(async () => {\n    const states = await searchStates();\n    setStateOptions(states);\n  }, []);\n  const onSuccessCallBack = useCallback(() => {\n    history.push(routes.representatives.path);\n  }, [history, routes.representatives.path]);\n  const formatPayload = useCallback(values => {\n    var _values$bankData$code, _values$bankData$code2, _values$financial, _values$financial$cli, _values$financial2, _values$financial2$cl, _values$financial3, _values$financial4, _values$maintenance$r, _values$maintenance$r2, _values$maintenance;\n\n    return { ...values,\n      billingPhone: trimMask(values.billingPhone),\n      cellphone: trimMask(values.cellphone),\n      commercialPhone: trimMask(values.commercialPhone),\n      cnpj: trimMask(values.cnpj),\n      stateRegistration: trimMask(values.stateRegistration),\n      bankData: { ...values.bankData,\n        code: (_values$bankData$code = values.bankData.code) === null || _values$bankData$code === void 0 ? void 0 : _values$bankData$code.code,\n        name: (_values$bankData$code2 = values.bankData.code) === null || _values$bankData$code2 === void 0 ? void 0 : _values$bankData$code2.description\n      },\n      financial: { ...values.financial,\n        clientGroupCode: Number(values === null || values === void 0 ? void 0 : (_values$financial = values.financial) === null || _values$financial === void 0 ? void 0 : (_values$financial$cli = _values$financial.clientGroup) === null || _values$financial$cli === void 0 ? void 0 : _values$financial$cli.codeClientGroup),\n        clientGroupDescription: values === null || values === void 0 ? void 0 : (_values$financial2 = values.financial) === null || _values$financial2 === void 0 ? void 0 : (_values$financial2$cl = _values$financial2.clientGroup) === null || _values$financial2$cl === void 0 ? void 0 : _values$financial2$cl.nameClientGroup,\n        issueBankSlip: !!values.financial.issueBankSlip,\n        generatesDebitNotice: !!values.financial.generatesDebitNotice,\n        calculatesFine: !!values.financial.calculatesFine,\n        receivesSciInformation: !!values.financial.receivesSciInformation,\n        simpleClient: !!values.financial.simpleClient,\n        icmsTaxpayer: !!values.financial.icmsTaxpayer,\n        buysPhilco: !!values.financial.buysPhilco,\n        fullNonCumulative: !!values.financial.fullNonCumulative,\n        receivesNfe: !!values.financial.receivesNfe,\n        expirationDate: ((_values$financial3 = values.financial) === null || _values$financial3 === void 0 ? void 0 : _values$financial3.expirationDate) ? formatFriendlyDateToBackFormat((_values$financial4 = values.financial) === null || _values$financial4 === void 0 ? void 0 : _values$financial4.expirationDate) : null\n      },\n      maintenance: { ...values.maintenance,\n        representativeGroupCode: ((_values$maintenance$r = values.maintenance.representativeGroup) === null || _values$maintenance$r === void 0 ? void 0 : _values$maintenance$r.code) || null,\n        representativeGroupName: ((_values$maintenance$r2 = values.maintenance.representativeGroup) === null || _values$maintenance$r2 === void 0 ? void 0 : _values$maintenance$r2.name) || null,\n        generationAdCarrier: Number((_values$maintenance = values.maintenance) === null || _values$maintenance === void 0 ? void 0 : _values$maintenance.generationAdCarrier),\n        commissionPercentage: Number(values.maintenance.commissionPercentage),\n        commissionEmissionPercentage: Number(values.maintenance.commissionEmissionPercentage),\n        minimumCommissionPercentage: Number(values.maintenance.minimumCommissionPercentage),\n        maximumCommissionPercentage: Number(values.maintenance.maximumCommissionPercentage),\n        manualCommission: Number(values.maintenance.manualCommission),\n        representativeType: Number(values.maintenance.representativeType),\n        intermediator: !!values.maintenance.intermediator\n      },\n      id\n    };\n  }, [id]);\n  const handleSaveSubmit = useCallback(async () => {\n    setSaveLoader(true);\n    formRef.current.setErrors({});\n    await formRef.current.setFieldTouched('cnpj');\n    const error = await formRef.current.validateField('cnpj');\n\n    if (!error) {\n      const values = formRef.current.getData();\n\n      if (!error) {\n        dispatch(RepresentativeActions.saveRepresentative(formatPayload(values), onSuccessCallBack, () => setSaveLoader(false)));\n      }\n    } else {\n      setSaveLoader(false);\n    }\n  }, [dispatch, formatPayload, onSuccessCallBack]);\n  const handleSubmit = useCallback(values => {\n    setConcludeLoader(true);\n    dispatch(RepresentativeActions.concludeRepresentative(formatPayload(values), onSuccessCallBack, () => setConcludeLoader(false)));\n  }, [dispatch, onSuccessCallBack, formatPayload]);\n  useFormEffect(() => {\n    if (!isEmpty(representativeFromApi)) {\n      var _representativeFromAp, _representativeFromAp2, _representativeFromAp3, _representativeFromAp4, _representativeFromAp5, _representativeFromAp6, _representativeFromAp7, _representativeFromAp8, _representativeFromAp9, _representativeFromAp10, _representativeFromAp11;\n\n      formRef.current.setData({ ...representativeFromApi,\n        financial: { ...representativeFromApi.financial,\n          issueBankSlip: representativeFromApi.financial.issueBankSlip,\n          generatesDebitNotice: representativeFromApi.financial.generatesDebitNotice,\n          calculatesFine: representativeFromApi.financial.calculatesFine,\n          receivesSciInformation: representativeFromApi.financial.receivesSciInformation,\n          simpleClient: representativeFromApi.financial.simpleClient,\n          icmsTaxpayer: representativeFromApi.financial.icmsTaxpayer,\n          buysPhilco: representativeFromApi.financial.buysPhilco,\n          fullNonCumulative: representativeFromApi.financial.fullNonCumulative,\n          receivesNfe: representativeFromApi.financial.receivesNfe,\n          expirationDate: (representativeFromApi === null || representativeFromApi === void 0 ? void 0 : (_representativeFromAp = representativeFromApi.financial) === null || _representativeFromAp === void 0 ? void 0 : _representativeFromAp.expirationDate) ? formatBackDateTimeToBackDateFormat(representativeFromApi.financial.expirationDate) : '',\n          clientGroup: {\n            codeClientGroup: (_representativeFromAp2 = representativeFromApi.financial) === null || _representativeFromAp2 === void 0 ? void 0 : _representativeFromAp2.clientGroupCode,\n            nameClientGroup: (_representativeFromAp3 = representativeFromApi.financial) === null || _representativeFromAp3 === void 0 ? void 0 : _representativeFromAp3.clientGroupDescription\n          }\n        },\n        maintenance: { ...representativeFromApi.maintenance,\n          representativeGroup: ((_representativeFromAp4 = representativeFromApi.maintenance) === null || _representativeFromAp4 === void 0 ? void 0 : _representativeFromAp4.representativeGroupCode) || ((_representativeFromAp5 = representativeFromApi.maintenance) === null || _representativeFromAp5 === void 0 ? void 0 : _representativeFromAp5.representativeGroupName) ? {\n            code: (_representativeFromAp6 = representativeFromApi.maintenance) === null || _representativeFromAp6 === void 0 ? void 0 : _representativeFromAp6.representativeGroupCode,\n            name: (_representativeFromAp7 = representativeFromApi.maintenance) === null || _representativeFromAp7 === void 0 ? void 0 : _representativeFromAp7.representativeGroupName\n          } : null,\n          intermediator: representativeFromApi.maintenance.intermediator,\n          generationAdCarrier: representativeFromApi.maintenance.generationAdCarrier\n        },\n        bankData: { ...representativeFromApi.bankData,\n          code: {\n            code: ((_representativeFromAp8 = representativeFromApi.bankData) === null || _representativeFromAp8 === void 0 ? void 0 : _representativeFromAp8.code) || '',\n            description: ((_representativeFromAp9 = representativeFromApi.bankData) === null || _representativeFromAp9 === void 0 ? void 0 : _representativeFromAp9.name) || '',\n            label: `${(_representativeFromAp10 = representativeFromApi.bankData) === null || _representativeFromAp10 === void 0 ? void 0 : _representativeFromAp10.code} - ${(_representativeFromAp11 = representativeFromApi.bankData) === null || _representativeFromAp11 === void 0 ? void 0 : _representativeFromAp11.name}` || ''\n          }\n        }\n      });\n    }\n  }, [representativeFromApi]);\n  useEffect(() => {\n    var _state$params3;\n\n    if (!(state === null || state === void 0 ? void 0 : (_state$params3 = state.params) === null || _state$params3 === void 0 ? void 0 : _state$params3.id) && mode !== 'create') {\n      history.replace(routes.representatives.path);\n    }\n  }, [history, mode, routes, state]);\n  useEffect(() => {\n    getStateOptions();\n  }, [getStateOptions]);\n  return /*#__PURE__*/React.createElement(Form, {\n    ref: formRef,\n    onSubmit: handleSubmit,\n    schemaConstructor: representativeSchema,\n    defaultValues: INITIAL_VALUES,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 5\n    }\n  }, loading && /*#__PURE__*/React.createElement(CircularLoader, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 20\n    }\n  }), /*#__PURE__*/React.createElement(Tabs, {\n    tabs: tabsOptions,\n    tabsContent: tabsContent,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    spacing: 1,\n    className: classes.buttons,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    sm: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 11\n    }\n  }, !modeView && /*#__PURE__*/React.createElement(I18n, {\n    as: Button,\n    className: classes.resetBtn,\n    disabled: loading,\n    variant: \"text\",\n    color: \"secondary\",\n    onClick: () => formRef.current.reset(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 267,\n      columnNumber: 15\n    }\n  }, \"clean\")), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    sm: 8,\n    style: {\n      display: 'flex',\n      justifyContent: 'flex-end'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 279,\n      columnNumber: 11\n    }\n  }, mode !== 'view' ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(I18n, {\n    as: Button,\n    variant: \"outlined\",\n    color: \"secondary\",\n    disabled: loading,\n    onClick: () => history.push(routes.representatives.path),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 282,\n      columnNumber: 17\n    }\n  }, \"cancel\"), /*#__PURE__*/React.createElement(I18n, {\n    as: Button,\n    color: \"secondary\",\n    variant: \"contained\",\n    className: classes.btnMargin,\n    disable: loading,\n    isLoading: saveLoader,\n    onClick: handleSaveSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 291,\n      columnNumber: 17\n    }\n  }, \"save\"), /*#__PURE__*/React.createElement(I18n, {\n    as: Button,\n    color: \"secondary\",\n    variant: \"contained\",\n    className: classes.btnMargin,\n    disabled: loading,\n    isLoading: concludeLoader,\n    onClick: () => formRef.current.submit(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 301,\n      columnNumber: 17\n    }\n  }, \"finish registration\")) : /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(I18n, {\n    as: Button,\n    variant: \"outlined\",\n    color: \"secondary\",\n    disabled: loading,\n    onClick: () => history.push(routes.representatives.path),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 314,\n      columnNumber: 17\n    }\n  }, \"turn back\"), /*#__PURE__*/React.createElement(I18n, {\n    as: Button,\n    color: \"secondary\",\n    variant: \"contained\",\n    className: classes.btnMargin,\n    disabled: loading,\n    onClick: () => {\n      var _state$params4;\n\n      return history.push(routes.editRepresentative.path, {\n        params: {\n          mode: 'edit',\n          id: state === null || state === void 0 ? void 0 : (_state$params4 = state.params) === null || _state$params4 === void 0 ? void 0 : _state$params4.id\n        }\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 323,\n      columnNumber: 17\n    }\n  }, \"edit\"))))));\n};\n\nexport default MainForm;","map":{"version":3,"sources":["/home/rafael/Documentos/britania/COM-front/packages/web/src/modules/representative/screens/RepresentativeFormScreen/MainForm.js"],"names":["React","useCallback","useMemo","useRef","useState","useEffect","useDispatch","useHistory","useLocation","isEmpty","Grid","Tab","useFormEffect","representativeSchema","INITIAL_VALUES","I18n","useT","representative","representativeCrmRoutes","searchStates","useCrmApi","RepresentativeActions","formatBackDateTimeToBackDateFormat","formatFriendlyDateToBackFormat","trimMask","Button","Form","CircularLoader","Tabs","useRoutes","Customer","Representative","useStyles","MainForm","t","classes","routes","history","dispatch","state","formRef","saveLoader","setSaveLoader","concludeLoader","setConcludeLoader","currentState","setCurrentState","stateOptions","setStateOptions","mode","params","modeView","id","data","representativeFromApi","loading","getLoading","getOne","replace","revalidateOnFocus","tabsOptions","howMany","getFieldAddress","address","current","setData","district","neighborhood","tabsContent","getStateOptions","states","onSuccessCallBack","push","representatives","path","formatPayload","values","billingPhone","cellphone","commercialPhone","cnpj","stateRegistration","bankData","code","name","description","financial","clientGroupCode","Number","clientGroup","codeClientGroup","clientGroupDescription","nameClientGroup","issueBankSlip","generatesDebitNotice","calculatesFine","receivesSciInformation","simpleClient","icmsTaxpayer","buysPhilco","fullNonCumulative","receivesNfe","expirationDate","maintenance","representativeGroupCode","representativeGroup","representativeGroupName","generationAdCarrier","commissionPercentage","commissionEmissionPercentage","minimumCommissionPercentage","maximumCommissionPercentage","manualCommission","representativeType","intermediator","handleSaveSubmit","setErrors","setFieldTouched","error","validateField","getData","saveRepresentative","handleSubmit","concludeRepresentative","label","buttons","resetBtn","reset","display","justifyContent","btnMargin","submit","editRepresentative"],"mappings":"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","sourcesContent":["import React, {\n  useCallback,\n  useMemo,\n  useRef,\n  useState,\n  useEffect\n} from 'react'\nimport { useDispatch } from 'react-redux'\nimport {\n  useHistory,\n  useLocation\n} from 'react-router-dom'\n\nimport isEmpty from 'lodash/isEmpty'\n\nimport Grid from '@material-ui/core/Grid'\nimport Tab from '@material-ui/core/Tab'\n\nimport { useFormEffect } from '@britania-crm/forms'\nimport representativeSchema, { INITIAL_VALUES } from '@britania-crm/forms/schemas/representative/representative.schema'\nimport I18n, { useT } from '@britania-crm/i18n'\nimport { representative as representativeCrmRoutes } from '@britania-crm/services/apis/crmApi/resources/routes'\nimport { searchStates } from '@britania-crm/services/apis/ibgeApi'\nimport useCrmApi from '@britania-crm/services/hooks/useCrmApi'\nimport { RepresentativeActions } from '@britania-crm/stores/representative'\nimport {\n  formatBackDateTimeToBackDateFormat,\n  formatFriendlyDateToBackFormat\n} from '@britania-crm/utils/date'\nimport { trimMask } from '@britania-crm/utils/formatters'\nimport Button from '@britania-crm/web-components/Button'\nimport Form from '@britania-crm/web-components/Form'\nimport { CircularLoader } from '@britania-crm/web-components/Loader'\nimport Tabs from '@britania-crm/web-components/Tabs'\nimport { useRoutes } from '@britania-crm/web-src/routes/authenticated.routes'\n\nimport Customer from './Customer'\nimport Representative from './Representative'\nimport useStyles from './styles'\n\nconst MainForm = () => {\n  const t = useT()\n  const classes = useStyles()\n  const { routes } = useRoutes()\n  const history = useHistory()\n  const dispatch = useCallback(useDispatch(), [])\n\n  const { state } = useLocation()\n  const formRef = useRef(null)\n\n  const [saveLoader, setSaveLoader] = useState(false)\n  const [concludeLoader, setConcludeLoader] = useState(false)\n  const [currentState, setCurrentState] = useState('')\n  const [stateOptions, setStateOptions] = useState([])\n\n  const mode = useMemo(() => state?.params?.mode, [state])\n  const modeView = useMemo(() => mode === 'view', [mode])\n  const id = useMemo(() => state?.params?.id, [state.params.id])\n\n  const { data: representativeFromApi, loading: getLoading } = useCrmApi(id ? [representativeCrmRoutes.getOne.replace(':id', id), id] : null, null, { revalidateOnFocus: false })\n\n  const loading = useMemo(\n    () => getLoading || saveLoader || concludeLoader,\n    [concludeLoader, getLoading, saveLoader]\n  )\n\n  const tabsOptions = useMemo(() => [\n    <Tab key={ 1 } label={ t('representative', { howMany: 1 }) }/>,\n    <Tab key={ 2 } label={ t('registration Parameterization') }/>\n  ], [t])\n\n  const getFieldAddress = useCallback(\n    (address) => {\n      formRef.current.setData({ address: { ...address, district: address.neighborhood } })\n    },\n    []\n  )\n\n  const tabsContent = useMemo(\n    () => [\n      <Representative\n        key={ 1 }\n        getFieldAddress={ getFieldAddress }\n        setCurrentState={ setCurrentState }\n        currentState={ currentState }\n        disabled={ modeView }\n        stateOptions={ stateOptions }\n        formRef={ formRef }\n      />,\n      <Customer\n        key={ 2 }\n        disabled={ modeView }\n        formRef={ formRef }\n      />\n    ],\n    [currentState, getFieldAddress, modeView, stateOptions]\n  )\n\n  const getStateOptions = useCallback(\n    async () => {\n      const states = await searchStates()\n      setStateOptions(states)\n    },\n    []\n  )\n\n  const onSuccessCallBack = useCallback(\n    () => {\n      history.push(routes.representatives.path)\n    },\n    [history, routes.representatives.path]\n  )\n\n  const formatPayload = useCallback(\n    (values) => ({\n      ...values,\n      billingPhone: trimMask(values.billingPhone),\n      cellphone: trimMask(values.cellphone),\n      commercialPhone: trimMask(values.commercialPhone),\n      cnpj: trimMask(values.cnpj),\n      stateRegistration: trimMask(values.stateRegistration),\n      bankData: {\n        ...values.bankData,\n        code: values.bankData.code?.code,\n        name: values.bankData.code?.description\n      },\n      financial: {\n        ...values.financial,\n        clientGroupCode: Number(values?.financial?.clientGroup?.codeClientGroup),\n        clientGroupDescription: values?.financial?.clientGroup?.nameClientGroup,\n        issueBankSlip: !!values.financial.issueBankSlip,\n        generatesDebitNotice: !!values.financial.generatesDebitNotice,\n        calculatesFine: !!values.financial.calculatesFine,\n        receivesSciInformation: !!values.financial.receivesSciInformation,\n        simpleClient: !!values.financial.simpleClient,\n        icmsTaxpayer: !!values.financial.icmsTaxpayer,\n        buysPhilco: !!values.financial.buysPhilco,\n        fullNonCumulative: !!values.financial.fullNonCumulative,\n        receivesNfe: !!values.financial.receivesNfe,\n        expirationDate: values.financial?.expirationDate ? formatFriendlyDateToBackFormat(values.financial?.expirationDate) : null\n      },\n      maintenance: {\n        ...values.maintenance,\n        representativeGroupCode: values.maintenance.representativeGroup?.code || null,\n        representativeGroupName: values.maintenance.representativeGroup?.name || null,\n        generationAdCarrier: Number(values.maintenance?.generationAdCarrier),\n        commissionPercentage: Number(values.maintenance.commissionPercentage),\n        commissionEmissionPercentage: Number(values.maintenance.commissionEmissionPercentage),\n        minimumCommissionPercentage: Number(values.maintenance.minimumCommissionPercentage),\n        maximumCommissionPercentage: Number(values.maintenance.maximumCommissionPercentage),\n        manualCommission: Number(values.maintenance.manualCommission),\n        representativeType: Number(values.maintenance.representativeType),\n        intermediator: !!values.maintenance.intermediator\n      },\n      id\n    }),\n    [id]\n  )\n\n  const handleSaveSubmit = useCallback(\n    async () => {\n      setSaveLoader(true)\n\n      formRef.current.setErrors({})\n      await formRef.current.setFieldTouched('cnpj')\n      const error = await formRef.current.validateField('cnpj')\n\n      if (!error) {\n        const values = formRef.current.getData()\n\n        if (!error) {\n          dispatch(RepresentativeActions.saveRepresentative(\n            formatPayload(values),\n            onSuccessCallBack,\n            () => setSaveLoader(false)\n          ))\n        }\n      } else {\n        setSaveLoader(false)\n      }\n    },\n    [dispatch, formatPayload, onSuccessCallBack]\n  )\n\n  const handleSubmit = useCallback(\n    (values) => {\n      setConcludeLoader(true)\n      dispatch(RepresentativeActions.concludeRepresentative(\n        formatPayload(values),\n        onSuccessCallBack,\n        () => setConcludeLoader(false)\n      ))\n    },\n    [dispatch, onSuccessCallBack, formatPayload]\n  )\n\n  useFormEffect(() => {\n    if (!isEmpty(representativeFromApi)) {\n      formRef.current.setData({\n        ...representativeFromApi,\n        financial: {\n          ...representativeFromApi.financial,\n          issueBankSlip: representativeFromApi.financial.issueBankSlip,\n          generatesDebitNotice: representativeFromApi.financial.generatesDebitNotice,\n          calculatesFine: representativeFromApi.financial.calculatesFine,\n          receivesSciInformation: representativeFromApi.financial.receivesSciInformation,\n          simpleClient: representativeFromApi.financial.simpleClient,\n          icmsTaxpayer: representativeFromApi.financial.icmsTaxpayer,\n          buysPhilco: representativeFromApi.financial.buysPhilco,\n          fullNonCumulative: representativeFromApi.financial.fullNonCumulative,\n          receivesNfe: representativeFromApi.financial.receivesNfe,\n          expirationDate: representativeFromApi?.financial?.expirationDate ? formatBackDateTimeToBackDateFormat(representativeFromApi.financial.expirationDate) : '',\n          clientGroup: { codeClientGroup: representativeFromApi.financial?.clientGroupCode, nameClientGroup: representativeFromApi.financial?.clientGroupDescription }\n        },\n        maintenance: {\n          ...representativeFromApi.maintenance,\n          representativeGroup:\n          representativeFromApi.maintenance?.representativeGroupCode ||\n          representativeFromApi.maintenance?.representativeGroupName ? {\n              code: representativeFromApi.maintenance?.representativeGroupCode,\n              name: representativeFromApi.maintenance?.representativeGroupName\n            } : null,\n          intermediator: representativeFromApi.maintenance.intermediator,\n          generationAdCarrier: representativeFromApi.maintenance.generationAdCarrier\n        },\n        bankData: {\n          ...representativeFromApi.bankData,\n          code: {\n            code: representativeFromApi.bankData?.code || '',\n            description: representativeFromApi.bankData?.name || '',\n            label: `${ representativeFromApi.bankData?.code } - ${ representativeFromApi.bankData?.name }` || ''\n          }\n        }\n      })\n    }\n  }, [representativeFromApi])\n\n  useEffect(\n    () => {\n      if (!state?.params?.id && mode !== 'create') {\n        history.replace(routes.representatives.path)\n      }\n    },\n    [history, mode, routes, state]\n  )\n\n  useEffect(() => {\n    getStateOptions()\n  }, [getStateOptions])\n\n  return (\n    <Form\n      ref={ formRef }\n      onSubmit={ handleSubmit }\n      schemaConstructor={ representativeSchema }\n      defaultValues={ INITIAL_VALUES }\n    >\n      { loading && <CircularLoader /> }\n\n      <Tabs\n        tabs={ tabsOptions }\n        tabsContent={ tabsContent }\n      >\n        <Grid container spacing={ 1 } className={ classes.buttons }>\n          <Grid item xs={ 12 } sm={ 4 }>\n            {!modeView && (\n              <I18n\n                as={ Button }\n                className={ classes.resetBtn }\n                disabled={ loading }\n                variant=\"text\"\n                color=\"secondary\"\n                onClick={ () => formRef.current.reset() }\n              >\n              clean\n              </I18n>\n            )}\n          </Grid>\n          <Grid item xs={ 12 } sm={ 8 } style={ { display: 'flex', justifyContent: 'flex-end' } }>\n            {mode !== 'view' ? (\n              <>\n                <I18n\n                  as={ Button }\n                  variant=\"outlined\"\n                  color=\"secondary\"\n                  disabled= { loading }\n                  onClick={ () => history.push(routes.representatives.path) }\n                >\n                  cancel\n                </I18n>\n                <I18n as={ Button }\n                  color=\"secondary\"\n                  variant=\"contained\"\n                  className={ classes.btnMargin }\n                  disable={ loading }\n                  isLoading={ saveLoader }\n                  onClick={ handleSaveSubmit }\n                >\n                  save\n                </I18n>\n                <I18n as={ Button }\n                  color=\"secondary\"\n                  variant=\"contained\"\n                  className={ classes.btnMargin }\n                  disabled={ loading }\n                  isLoading={ concludeLoader }\n                  onClick={ () => formRef.current.submit() }\n                >\n                  finish registration\n                </I18n>\n              </>\n            ) : (\n              <>\n                <I18n\n                  as={ Button }\n                  variant=\"outlined\"\n                  color=\"secondary\"\n                  disabled= { loading }\n                  onClick={ () => history.push(routes.representatives.path) }\n                >\n                  turn back\n                </I18n>\n                <I18n as={ Button }\n                  color=\"secondary\"\n                  variant=\"contained\"\n                  className={ classes.btnMargin }\n                  disabled={ loading }\n                  onClick={ () => history.push(routes.editRepresentative.path, {\n                    params: {\n                      mode: 'edit',\n                      id: state?.params?.id\n                    }\n                  }) }\n                >\n                edit\n                </I18n>\n              </>\n            )}\n          </Grid>\n        </Grid>\n      </Tabs>\n    </Form>\n  )\n}\n\nexport default MainForm\n"]},"metadata":{},"sourceType":"module"}