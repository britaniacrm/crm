{"ast":null,"code":"import { put, call, takeLatest } from 'redux-saga/effects';\nimport doDownloadFile from 'js-file-download';\nimport { MSG003, MSG033 } from '@britania-crm/constants/feedbackMessages.constants';\nimport { download } from '@britania-crm/services/apis/crmApi/resources/app.service';\nimport { saveFan, putFan, concludeFan, saveDocuments, deleteDocument } from '@britania-crm/services/apis/crmApi/resources/fan.service';\nimport { uploadSingleFile } from '@britania-crm/services/apis/crmApi/resources/file.service';\nimport { AppActions } from '../app/app.actions';\nimport { FanTypes } from './fan.actions';\n\nfunction* doSaveFan({\n  fan,\n  onSuccess = () => {},\n  onError = () => {}\n}) {\n  try {\n    const response = yield call(saveFan, fan);\n    yield call(onSuccess, response.data);\n    yield put(AppActions.addAlert({\n      type: 'success',\n      message: MSG003\n    }));\n  } catch (error) {\n    yield call(onError, false);\n    yield put(AppActions.addAlert({\n      type: 'error',\n      message: 'Falha ao cadastrar FAN.'\n    }));\n  }\n}\n\nfunction* doConcludeFan({\n  id,\n  onSuccess = () => {},\n  onError = () => {}\n}) {\n  try {\n    yield call(concludeFan, id);\n    yield call(onSuccess);\n    yield put(AppActions.addAlert({\n      type: 'success',\n      message: MSG003\n    }));\n  } catch (error) {\n    yield call(onError, false);\n    yield put(AppActions.addAlert({\n      type: 'error',\n      message: 'Falha ao iniciar fluxo de tarefa do FAN.'\n    }));\n  }\n}\n\nfunction* doUpdateFan({\n  id,\n  params,\n  onSuccess = () => {},\n  onError = () => {}\n}) {\n  try {\n    yield call(putFan, id, params);\n    yield call(onSuccess);\n    yield put(AppActions.addAlert({\n      type: 'success',\n      message: MSG003\n    }));\n  } catch (error) {\n    yield call(onError, false);\n    yield put(AppActions.addAlert({\n      type: 'error',\n      message: 'Falha ao editar FAN.'\n    }));\n  }\n}\n\nfunction* doUploadFileFan({\n  data,\n  idFan,\n  onSuccess\n}) {\n  try {\n    if (!(data === null || data === void 0 ? void 0 : data.path)) {\n      const formData = new FormData();\n      formData.append('file', data.file);\n      const response = yield call(uploadSingleFile, formData);\n      yield call(onSuccess, { ...data,\n        ...response,\n        fileId: response.id\n      });\n      yield call(saveDocuments, idFan, {\n        documents: [{\n          description: data.description,\n          fileId: response.id,\n          filename: data.filename\n        }]\n      });\n      yield put(AppActions.addAlert({\n        type: 'success',\n        message: 'Arquivo salvo com sucesso!'\n      }));\n    } else {\n      yield call(onSuccess, data);\n    }\n  } catch (error) {\n    yield put(AppActions.addAlert({\n      type: 'error',\n      message: MSG033\n    }));\n  }\n}\n\nfunction* doDeleteFileFan({\n  id,\n  onSuccess\n}) {\n  try {\n    yield call(deleteDocument, id);\n    yield call(onSuccess);\n  } catch (error) {\n    yield put(AppActions.addAlert({\n      type: 'error',\n      message: MSG033\n    }));\n  }\n}\n\nfunction* doDowloadFileFan({\n  url,\n  filename\n}) {\n  try {\n    const response = yield call(download, encodeURIComponent(url));\n    doDownloadFile(response, filename);\n  } catch (error) {\n    yield put(AppActions.addAlert({\n      type: 'error',\n      message: 'Falha ao baixar arquivo!'\n    }));\n  }\n}\n\nexport default [takeLatest(FanTypes.SAVE_FAN, doSaveFan), takeLatest(FanTypes.CONCLUDE_FAN, doConcludeFan), takeLatest(FanTypes.UPDATE_FAN, doUpdateFan), takeLatest(FanTypes.UPLOAD_FILE_FAN, doUploadFileFan), takeLatest(FanTypes.DOWNLOAD_FILE_FAN, doDowloadFileFan), takeLatest(FanTypes.DELETE_FILE_FAN, doDeleteFileFan)];","map":{"version":3,"sources":["/home/rafael/Documentos/britania/COM-front/packages/core/stores/fan/fan.sagas.js"],"names":["put","call","takeLatest","doDownloadFile","MSG003","MSG033","download","saveFan","putFan","concludeFan","saveDocuments","deleteDocument","uploadSingleFile","AppActions","FanTypes","doSaveFan","fan","onSuccess","onError","response","data","addAlert","type","message","error","doConcludeFan","id","doUpdateFan","params","doUploadFileFan","idFan","path","formData","FormData","append","file","fileId","documents","description","filename","doDeleteFileFan","doDowloadFileFan","url","encodeURIComponent","SAVE_FAN","CONCLUDE_FAN","UPDATE_FAN","UPLOAD_FILE_FAN","DOWNLOAD_FILE_FAN","DELETE_FILE_FAN"],"mappings":"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","sourcesContent":["import {\n  put,\n  call,\n  takeLatest\n} from 'redux-saga/effects'\n\nimport doDownloadFile from 'js-file-download'\n\nimport {\n  MSG003,\n  MSG033\n} from '@britania-crm/constants/feedbackMessages.constants'\nimport { download } from '@britania-crm/services/apis/crmApi/resources/app.service'\nimport {\n  saveFan,\n  putFan,\n  concludeFan,\n  saveDocuments,\n  deleteDocument\n} from '@britania-crm/services/apis/crmApi/resources/fan.service'\nimport { uploadSingleFile } from '@britania-crm/services/apis/crmApi/resources/file.service'\n\nimport { AppActions } from '../app/app.actions'\nimport { FanTypes } from './fan.actions'\n\nfunction* doSaveFan ({\n  fan, onSuccess = () => {}, onError = () => {}\n}) {\n  try {\n    const response = yield call(saveFan, fan)\n    yield call(onSuccess, response.data)\n    yield put(AppActions.addAlert({ type: 'success', message: MSG003 }))\n  } catch (error) {\n    yield call(onError, false)\n    yield put(AppActions.addAlert({ type: 'error', message: 'Falha ao cadastrar FAN.' }))\n  }\n}\n\nfunction* doConcludeFan ({\n  id, onSuccess = () => {}, onError = () => {}\n}) {\n  try {\n    yield call(concludeFan, id)\n    yield call(onSuccess)\n    yield put(AppActions.addAlert({ type: 'success', message: MSG003 }))\n  } catch (error) {\n    yield call(onError, false)\n    yield put(AppActions.addAlert({ type: 'error', message: 'Falha ao iniciar fluxo de tarefa do FAN.' }))\n  }\n}\n\nfunction* doUpdateFan ({\n  id, params, onSuccess = () => {}, onError = () => {}\n}) {\n  try {\n    yield call(putFan, id, params)\n    yield call(onSuccess)\n    yield put(AppActions.addAlert({ type: 'success', message: MSG003 }))\n  } catch (error) {\n    yield call(onError, false)\n    yield put(AppActions.addAlert({ type: 'error', message: 'Falha ao editar FAN.' }))\n  }\n}\n\nfunction* doUploadFileFan ({\n  data, idFan, onSuccess\n}) {\n  try {\n    if (!data?.path) {\n      const formData = new FormData()\n      formData.append('file', data.file)\n      const response = yield call(uploadSingleFile, formData)\n      yield call(onSuccess, {\n        ...data, ...response, fileId: response.id\n      })\n\n      yield call(saveDocuments, idFan, {\n        documents: [{\n          description: data.description,\n          fileId: response.id,\n          filename: data.filename\n        }]\n      })\n\n      yield put(AppActions.addAlert({ type: 'success', message: 'Arquivo salvo com sucesso!' }))\n    } else {\n      yield call(onSuccess, data)\n    }\n  } catch (error) {\n    yield put(AppActions.addAlert({ type: 'error', message: MSG033 }))\n  }\n}\n\nfunction* doDeleteFileFan ({ id, onSuccess }) {\n  try {\n    yield call(deleteDocument, id)\n    yield call(onSuccess)\n  } catch (error) {\n    yield put(AppActions.addAlert({ type: 'error', message: MSG033 }))\n  }\n}\n\nfunction* doDowloadFileFan ({ url, filename }) {\n  try {\n    const response = yield call(download, encodeURIComponent(url))\n\n    doDownloadFile(response, filename)\n  } catch (error) {\n    yield put(AppActions.addAlert({ type: 'error', message: 'Falha ao baixar arquivo!' }))\n  }\n}\n\nexport default [\n  takeLatest(FanTypes.SAVE_FAN, doSaveFan),\n  takeLatest(FanTypes.CONCLUDE_FAN, doConcludeFan),\n  takeLatest(FanTypes.UPDATE_FAN, doUpdateFan),\n  takeLatest(FanTypes.UPLOAD_FILE_FAN, doUploadFileFan),\n  takeLatest(FanTypes.DOWNLOAD_FILE_FAN, doDowloadFileFan),\n  takeLatest(FanTypes.DELETE_FILE_FAN, doDeleteFileFan)\n]\n"]},"metadata":{},"sourceType":"module"}